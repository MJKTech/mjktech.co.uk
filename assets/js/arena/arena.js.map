{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/arena.js","webpack:///./src/core/compiler.js","webpack:///./src/core/provider.js","webpack:///./src/core/providers/controllerDirective.js","webpack:///./src/core/providers/mainViewDirective.js","webpack:///./src/core/providers/routerService.js","webpack:///./src/core/scope.js","webpack:///./src/utilities/BreakpointMonitor.js","webpack:///./src/utilities/Cookie.js","webpack:///./src/utilities/GestureMonitor.js","webpack:///./src/utilities/ScrollMonitor.js","webpack:///./src/utilities/TransitionMonitor.js","webpack:///./src/utilities/Util.js","webpack:///./src/utilities/ViewportMonitor.js","webpack:///./src/utilities/browsxr.js","webpack:///./src/utilities/loadImgSrc.js","webpack:///./src/utilities/makeEventDispatch.js","webpack:///./src/utilities/pLitr.js","webpack:///./src/utilities/provisionaryPromise.js","webpack:///./src/utilities/viewUpdater.js"],"names":["$","undefined","$win","window","$doc","document","$html","documentElement","defaultConfig","html5Mode","autoBootstrap","rootElementSelector","defaultTransitionSpeed","Scope","require","Provider","Compiler","Util","components","directive","controller","service","$browser","$cookie","Promise","provisionaryPromise","MakeEventDispatch","ViewportMonitor","ScrollMonitor","BreakpointMonitor","TransitionMonitor","GestureMonitor","viewUpdater","loadImgSrc","addNavigatorDataToHtml","addJSClass","Arena","_config_","a","rootScope","startupPromises","deleteObjProp","$config","objectAssign","isString","name","$provider","$compiler","$directive","apply","arguments","$controller","$service","alias","forEach","storage","storageId","storageName","setItem","key","val","getItem","$bootstrapDefer","p","Array","isArray","concat","then","push","$bootstrap","$rootElement","eq","$viewportMonitor","$scrollMonitor","$breakpointMonitor","mobile","desktop","$on","$trigger","compileDOM","bootstrapResolutions","compile","all","catch","ready","prototype","split","providerName","fn","Error","objectKeys","utilName","ARENA","module","exports","define","jQuery","compilerId","util","provider","compiler","testCache","findDirectives","el","locals","result","directiveList","length","slice","DirectiveTester","tester","index","test","parent","linkToElement","terminal","autoCompile","parentScope","getScope","parentNode","existingScope","getCompilerData","scope","existingDirectives","matchingDirectives","diff","compilingThisElement","directivesRequireScope","requiresScope","directivesRequireIsolatedScope","requiresIsolateScope","compileDefer","$destroy","$create","wrappedEl","elementData","data","endCompileNode","setCompilerData","on","$once","off","removeClass","triggerHandler","addClass","linkDirectiveToNode","directiveData","directiveController","instantiate","$scope","link","e","console","error","$deferCompile","promise","call","childNodes","compileNode","child","nameSanitized","replace","nameDashed","toLowerCase","tests","indexOf","classRegEx","RegExp","checkClass","className","idTest","checkId","getAttribute","checkAttribute","nodeName","hasAttribute","runAllTests","tagName","i","A","B","filter","x","directives","prop","element","Math","random","Zepto","DIRECTIVE_SUFFIX","CONTROLLER_SUFFIX","extractParamNames","params","toString","match","map","trim","construct","constructor","args","C","_components_","providers","cache","$$directiveSelectors","getDependencies","f","$dependencies","s","checkSecurity","directiveName","providr","cached","invoke","controllerName","$cache","extendFn","hasAlias","aliasType","_type_","originalDirective","Object","create","componentName","controllerDirective","$app","controllerAs","$element","contoller","isFunction","mainViewDirective","$router","$window","ROOT_VIEW","ACTIVE_VIEWS","mainView","scrollTo","cssTransitions","changeAppRoute","linkSelector","linkFilter","requestMethod","requestHeaders","loadingClass","targetLoadingClass","errorPage","onServerError","request","confirm","location","url","updateTarget","$target","find","attr","historyAPI","setInitialState","handleStateChange","handleClicks","triggerElement","history","state","$$ARENA","replaceState","buildStateObject","title","href","options","targetElement","method","requestData","headers","event","$this","clickData","which","metaKey","is","ajaxHref","pathname","isValidRoute","isDefined","ajaxRequestCallback","callback","preventDefault","stopPropagation","originalEvent","targetView","search","routerProvider","RouterService","router","_blacklist_","base","isInternalRoute","path","substring","l","blacklist","paths","evalHtmlResponse","html","targetSelector","skipSanitization","sanitizedHtml","getDocumentHtml","metaData","getDocumentMeta","targetHtml","get","scripts","getDocumentScript","navigate","type","pushState","updatePageTitle","ajax","resolve","reject","success","textStatus","jqXHR","errorThrown","http","onSuccess","response","dataEval","status","onError","_html_","decodeURI","text","sanitize","String","makeEventDispatch","id","$children","$id","$parent","createScope","isolate","newScope","S","$root","destroyScope","c","siblings","splice","$destroyDispatch","$$watchers","$destroyed","emitEvent","__propagationStopped__","childScope","$emit","broadcastEvent","$broadcast","testThreshold","breakpoints","operator","breakpointName","w","innerWidth","clientWidth","t","annotateElement","breakpoint","lastBreakpointClassString","classes","m","resizeHandler","classString","oldBreakpoint","currentBreakpoint","newBreakpoint","refresh","destroy","set","cookieName","cookieValue","lifeInDays","domain","secure","expiryDate","today","Date","setTime","getTime","cookie","escape","toGMTString","cookieArray","u","substr","msPointerEnabled","navigator","pointerEnabled","msEventType","HASTOUCH","userAgent","TOUCHEVENTS","touchstart","touchend","touchmove","OPTIONS","swipeThreshold","tapThreshold","dbltapThreshold","tapPrecision","justTouchEvents","getPointerEvent","targetTouches","newTimestamp","setListener","elm","events","eventsArray","addEventListener","SwipeMonitor","opt","tapNum","currX","currY","cachedX","cachedY","tapTimer","timestamp","target","sendEvent","eventName","y","distance","trigger","onTouchStart","pointer","pageX","pageY","onTouchEnd","eventsArr","deltaY","deltaX","clearTimeout","abs","setTimeout","onTouchMove","$htmlBody","ids","winWidth","winHeight","updateWindowDimensions","innerHeight","clientHeight","ElementTracker","scrollMonitor","thresholdX","thresholdY","et","getBoundingClientRect","checkPosition","rect","elH","height","offsetHeight","elW","width","offsetWidth","ofsX","ofsY","topInBounds","top","bottomInBounds","bottom","rightInBounds","right","leftInBounds","left","xCovered","yCovered","xVisible","yVisible","triggerEvents","scrollEvent","unMonitor","topInView","bottomInView","rightInView","leftInView","isInView","newState","wasVisible","isVisible","createEvent","eventType","scrollData","edge","inBoundsProp","inViewProp","edgeIsVisbible","monitoredElement","$el","bindingsMap","updateScrollData","prvPosition","position","scrollTop","scrollDirection","bind","binding","tracker","unbind","getOffset","css","offset","speed","before","after","sp","_o","jquery","animate","done","TRANSITIONEVENT","transitions","ANIMATIONEVENT","animations","tm","start","triggerTS","end","triggerTE","triggerAS","triggerAE","tmEvnt","isElement","srcElement","originalTarget","maxDuration","timeout","manipulate","toggleClass","manipulation","fail","ended","resolvePromise","utils","browsxr","requestAnimationFrame","getRaf","cancelAnimationFrame","getCaf","isUndefined","isObject","isNumber","arrayDiff","assign","output","source","k","hasOwnProperty","copyObject","obj","objectToArray","arr","objectLength","keys","count","toCamelCalse","input","delimiters","regX","group1","toUpperCase","camelCaseTo","str","op","generateHash","useNumbers","characters","rl","charAt","floor","randomNumber","max","min","preventEvent","stopImmediate","allowPropagation","stopImmediatePropagation","debounce","delay","range","timer","context","addCSSRule","selector","rules","sheet","styleSheets","cssRules","insertRule","addRule","getElementsByTagName","innerHTML","Exception","setAttribute","platform","h","getInnerVH","screen","outerHeight","setInnerVHVar","vhVarName","style","setProperty","toggleOverflow","classn","tog","_hiding","IOS","lastFrameTime","raf","webkitRequestAnimationFrame","mozRequestAnimationFrame","currTime","timeToCall","cb","caf","webkitCancelAnimationFrame","mozCancelAnimationFrame","webkitCancelRequestAnimationFrame","mozCancelRequestAnimationFrame","monitorCount","viewportDimensions","monitorDispatch","WINDOW_RESIZE_EVENT","updateviewportDimensions","prvWidth","prvHeight","resizeEvent","updateListners","$off","d","ua","body","documentComputedStyle","getComputedStyle","b","lastAnimationFrame","cookiesEnabled","cookieEnabled","IE","parseFloat","appVersion","Chrome","Webkit","Opera","Mobile","mediaQueries","Modernizr","mq","touch","backgroundSizing","prefix","pre","join","OLink","dom","lowercase","js","placeholders","createElement","supports","supportsSvgImg","implementation","hasFeature","ct","ttc","src","image","Image","onload","onerror","complete","naturalWidth","owner","dispatch","listeners","removeListener","callbackOnceThen$off","stack","_event","_list","__eventStopped__","PLitr","resolver","promiseChain","resultGetter","buildChain","onsuccess","onfailure","prevChain","processResult","err","setResult","callbackRunner","successCallback","failCallback","ex","setSuccess","setError","resolveCallback","promises","len","decrement","waitFor","testName","timeToWait","interval","frequency","testRunner","stopTrying","clearInterval","setInterval","runTest","passingResult","useCssTransitions","transitionInClass","transitionOutClass","monitor","hasClass","htmlUpdate","httpSuccess","$replacement","insertBefore","remove","$targetScope","endUpdate","httpError","redirectedUrl","alert"],"mappings":"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","file":"arena.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/arena.js\");\n","/** \n * @global ARENA\n * @description \n * \t\tThe ArenaJs front-end framework is a toolbox that evolved to help develop a website as \n * \t\ta single-page-app.\n * \t\tUsing the principle of progressive enhancement, unobtrusive JavaScript can be used \n * \t\tto quickly augment a functional MVP and apply more advanced, non-essential features as the \n * \t\tenvironment permits, in a non-pollutive way. \n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n * @license: Apache-2.0\n * @version: 0.5.5\n * @requires jQuery\n */\n\n/** \n * @fires $app#$bootstrapStart\n *\t\t- When bootstrapping of app begins (after loading promises resolve but before DOM is $compiled).\n *\t\t  The bootstrap events can be used to coordinate configuration of components.\n *\t\t  During the bootstrapping process, $app.$bootstrap === false.\n * @fires $app#$bootstrapEnd\n * \t\t- When bootstrapping of app ends (just after DOM is $compiled).\n *\t\t  After the bootstrap process has ended, $app.$bootstrap === true.\n *\n * @example \n\t\t`<html>\n\t\t<head />\n\t\t<body main-view=\"main\">\n\t\t\t<header />\n\t\t\t\n\t\t\t<main> \n\t\t\t\t<!-- Your page content updated using xhr (ajax) requests: -->\n\t\t\t\t<button data-change-colour-to=\"blue\">Change blue!</button>\n\t\t\t\t<button change-colour-to>Change black!</button>\n\t\t\t</main>\n\t\t\t\n\t\t\t<footer />\n\t\t\t\n\t\t\t<!--[if lt IE 9]> <script src=\"polyfills.js\"></script> <![endif]-->\n\t\t\t<script src=\"jquery.js\"></script>\n\t\t\t<script src=\"arena.js\"></script>\n\t\t\t<script>\n\t\t\t\tvar yourApp = new ARENA(\"yourAppName\");\n\t\t\t\tyourApp.$directive(\"changeColourTo\", function () {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tscope: true,\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tchangeColourTo: 'black'\t//<- default value\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlink: function ($element, scope, data) {\n\t\t\t\t\t\t\t$element.on('click', function () {\n\t\t\t\t\t\t\t\tthis.style.backgroundColor = data.changeColourTo;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tscope.$on(\"$destroy\", function (e) {\n\t\t\t\t\t\t\t\t$element.off('click');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t\tyourApp.$on(\"$bootstrapEnd\", function (event) {\n\t\t\t\t\t$('body').addClass('page-ready');\n\t\t\t\t});\n\t\t\t</script>\n\t\t</body>\n\t\t</html>`\n *\n */\n\n(function ($, undefined) {\n  'use strict';\n\t\n\tvar $win = $(window),\n\t\t$doc = $(document),\n\t\t$html = $(document.documentElement),\n\t\tdefaultConfig = {\n\t\t\thtml5Mode: true,\t\t\t\t\t// Will be ignored if html5 history api missing\n\t\t\tautoBootstrap: true,\t\t\t\t// Bootstrap automatically (use $app.$bootstrap() elsewise)\n\t\t\trootElementSelector: 'html',\t\t// Bind app to this DOM element\n\t\t\tdefaultTransitionSpeed: 300\t\t\t// Transitions will take this long by default\n\t\t};\n\t\n\tvar Scope = require(\"./core/scope.js\"),\n\t\tProvider = require(\"./core/provider.js\"),\n\t\tCompiler = require(\"./core/compiler.js\"),\n\t\tUtil = require(\"./utilities/Util.js\"),\n\t\tcomponents = {directive: {}, controller: {}, service: {}};\n\t\n\tUtil.$ = $;\n\tUtil.$browser = require(\"./utilities/browsxr.js\");\n\tUtil.$cookie = require(\"./utilities/Cookie.js\");\n\tUtil.Promise = require(\"./utilities/pLitr.js\");\n\tUtil.provisionaryPromise = require(\"./utilities/provisionaryPromise.js\");\n\tUtil.MakeEventDispatch = require(\"./utilities/makeEventDispatch.js\");\n\tUtil.ViewportMonitor = require(\"./utilities/ViewportMonitor.js\");\n\tUtil.ScrollMonitor = require(\"./utilities/ScrollMonitor.js\");\n\tUtil.BreakpointMonitor = require(\"./utilities/BreakpointMonitor.js\");\n\tUtil.TransitionMonitor = require(\"./utilities/TransitionMonitor.js\");\n\tUtil.GestureMonitor = require(\"./utilities/GestureMonitor.js\");\n\tUtil.viewUpdater = require(\"./utilities/viewUpdater.js\");\n\tUtil.loadImgSrc = require(\"./utilities/loadImgSrc.js\");\n\tUtil.addNavigatorDataToHtml();\n\tUtil.addJSClass();\n\t\n\tfunction Arena(_config_) {\n\t\tvar a = new Util.MakeEventDispatch(this),\n\t\t\trootScope = new Scope(),\n\t\t\tstartupPromises = [];\n\n\t\ta.deleteObjProp(a, '$destroyDispatch');\t\n\t\ta.$config = a.objectAssign({}, defaultConfig, a.isString(_config_)? {name: _config_} : _config_);\n\t\ta.$provider = new Provider(components);\n\t\ta.$compiler = new Compiler(a.$provider);\n\t\ta.$directive = function () { return a.$provider.directive.apply(a, arguments) };\n\t\ta.$controller = function () { return a.$provider.controller.apply(a, arguments) };\n\t\ta.$service = function () { return a.$provider.service.apply(a, arguments) };\n\t\t\n\t\ta.$provider.service('$app', function () { return a; }).alias('$app', a.$config.name);\n\t\t\n\t\t/* Exclusive local storage for this app */\n\t\t[\"sessionStorage\", \"localStorage\"].forEach(function (storage) {\n\t\t\tvar storageId = a.$config.name+\"_$$storage_\",\n\t\t\t\tstorageName = '$'+storage;\n\t\t\ta[storageName] = {\n\t\t\t\tsetItem: function (key, val) { window[storage].setItem(storageId+key, val) },\n\t\t\t\tgetItem: function (key) { return window[storage].getItem(storageId+key) }\n\t\t\t};\n\t\t\ta.$provider.service(storageName, function () { return a[storageName] });\n\t\t});\n\t\t\n\t\t/* Accept promises which must resolve for bootstrap to be completed. */\n\t\ta.$bootstrapDefer = function (p) {\n\t\t\tif (Array.isArray(p)) startupPromises = startupPromises.concat(p);\n\t\t\telse if (p.then) startupPromises.push(p);\n\t\t};\n\t\t\n\t\ta.$service('$rootScope', function () { return rootScope })\n\t\t\t.$service('$config', function () { return a.$config });\n\t\t\n\t\t/* Setup the app and compile the DOM. */\n\t\ta.$bootstrap = function () {\n\t\t\tvar $rootElement = $(a.$config.rootElementSelector).eq(0);\n\t\t\ta.$bootstrap = false;\n\t\t\ta.$service('$rootElement', function () { return $rootElement });\n\t\t\ta.$viewportMonitor = new a.ViewportMonitor();\n\t\t\ta.$scrollMonitor = new a.ScrollMonitor(window);\n\t\t\ta.$breakpointMonitor = new a.BreakpointMonitor({mobile: [0, 540], desktop: [541, 16384]}, $rootElement);\n\t\t\ta.$breakpointMonitor.$on(\"viewportBreakpointChanged\", a.$trigger);\n\t\t\ta.$service('$viewportMonitor', function () { return a.$viewportMonitor })\n\t\t\t .$service('$scrollMonitor', function () { return a.$scrollMonitor })\n\t\t\t .$service('$breakpointMonitor', function () { return a.$breakpointMonitor });\n\t\t\t\n\t\t\tfunction compileDOM(bootstrapResolutions) {\n\t\t\t\ta.$compiler.compile($rootElement[0], rootScope);\n\t\t\t\treturn bootstrapResolutions;\n\t\t\t}\n\t\t\t\n\t\t\ta.$trigger(\"$bootstrapStart\");\n\t\t\treturn a.Promise.all(startupPromises)\n\t\t\t\t.then(compileDOM).catch(compileDOM)\n\t\t\t\t.then(function (bootstrapResolutions) {\n\t\t\t\t\ta.$bootstrap = true;\n\t\t\t\t\ta.$trigger(\"$bootstrapEnd\");\n\t\t\t\t\treturn bootstrapResolutions;\n\t\t\t\t});\n\t\t};\n\t\t\n\t\tif (a.$config.autoBootstrap) $doc.ready(a.$bootstrap);\n\t}\n\n\tArena.prototype = Util;\n\t\n\t'directive controller service'.split(' ').forEach(function (providerName) {\n\t\tArena['$'+providerName] = function (name, fn) {\n\t\t\tif (components[providerName][name]) throw new Error(\"Provider already exists: \"+name);\n\t\t\telse components[providerName][name] = fn;\n\t\t\treturn Arena;\n\t\t};\n\t});\n\t\n\tUtil.objectKeys(Util).forEach(function (utilName) {\n\t\tArena.$service(utilName, function () { return Util[utilName] });\n\t});\t\n\t\n\tArena\n\t\t.$service('$html', function () { return $html })\n\t\t.$service('$window', function () { return $win })\n\t\t.$service('$document', function () { return $doc })\n\t\t.$service(\"$router\", require(\"./core/providers/routerService.js\"))\n\t\t.$directive(\"controller\", require(\"./core/providers/controllerDirective.js\"))\n\t\t.$directive(\"mainView\", require(\"./core/providers/mainViewDirective.js\"));\n\t\n\twindow.ARENA = Arena;\n\tif (typeof module !== 'undefined' && module.exports) module.exports = Arena;\n\tif (typeof define == 'function' && define.amd) define(function(){ return Arena });\n})(jQuery);","/** \n * @class Compiler\n *\n * @description \n *\t\tCompile the DOM into views by finding directives and linking to scopes and controllers.\n * \n * @example\n \t\t`var directiveProvider = function (aDependency) {\n\t\t \treturn {link: function ($scope, $element) {\n\t\t\t\taDependency.doSomethingWith($element);\n\t\t\t}};\n\t\t };\n\t\t directiveProvider.$dependencies = [\"aDependency\"];\n\t\t \n\t\t var $provider = new Provider();\n\t\t $provider.directive(\"directiveName\", directiveProvider);\n\t\t $provider.service(\"aDependency\", function dependencyProvider() {return aDependency;});\n\t\t \n\t\t var $rootScope = new Scope();\n\t\t var rootElement = document.querySelector('html');\n\t\t \n\t\t var $compiler = new Compiler($provider);\n\t\t $compiler.compile(rootElement, $rootScope);`\n * \n * @requires Provider\n * @requires Scope\n * @requires jQuery\n * @requires Promise\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nvar Compiler = (function (compilerId, $, Promise, util) {\n\t'use strict';\n\t\n\tfunction Compiler(provider) {\n\t\tvar compiler = this,\n\t\t\ttestCache = [];\n\t\t\n\t\tthis.provider = provider;\n\t\t\n\t\tthis.findDirectives = function findDirectives(el, locals) {\n\t\t\tvar result = [];\n\n\t\t\tvar directiveList = provider.directive();\t// Cache tests for supa speed\n\t\t\tif (directiveList.length !== testCache.length) {\n\t\t\t\tdirectiveList.slice(testCache.length)\n\t\t\t\t\t.forEach(function (name) { \n\t\t\t\t\t\ttestCache.push(new DirectiveTester(name)); \n\t\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\ttestCache.forEach(function (tester, index) {\n\t\t\t\tif (tester.test(el)) result.push(provider.directive(tester.name, null, locals));\n\t\t\t});\n\t\t\treturn result;\n\t\t};\n\t\t\n\t\tthis.compile = function compile(el, parent, linkToElement, terminal, autoCompile) {\n\t\t\tvar parentScope = parent || getScope(el.parentNode),\n\t\t\t\texistingScope = getCompilerData(el, '$scope'),\n\t\t\t\tscope = existingScope,\n\t\t\t\texistingDirectives = getCompilerData(el, '$directives') || [],\n\t\t\t\tmatchingDirectives = diff(compiler.findDirectives(el, {}), existingDirectives),\n\t\t\t\tcompilingThisElement = !!matchingDirectives.length,\n\t\t\t\tdirectivesRequireScope = requiresScope(matchingDirectives),\n\t\t\t\tdirectivesRequireIsolatedScope = requiresIsolateScope(matchingDirectives),\n\t\t\t\tcompileDefer = [];\n\t\t\t\n\t\t\tif (linkToElement) {\n\t\t\t\tif (existingScope) existingScope.$destroy();\n\t\t\t\tlinkToElement = scope = parent? parentScope : parentScope.$create(directivesRequireIsolatedScope);\n\t\t\t} else if (compilingThisElement && directivesRequireScope && !existingScope) {\n\t\t\t\tlinkToElement = scope = parentScope.$create(directivesRequireIsolatedScope);\n\t\t\t}\n\t\t\t\n\t\t\tvar wrappedEl = compilingThisElement || linkToElement? $(el) : null,\n\t\t\t\telementData = wrappedEl? wrappedEl.data() : null;\n\t\t\t\n\t\t\tif (!scope) scope = parentScope;\n\t\t\t\n\t\t\tfunction endCompileNode() {\n\t\t\t\tif (linkToElement) {\n\t\t\t\t\tsetCompilerData(el, '$scope', linkToElement);\n\t\t\t\t\twrappedEl.on('$destroy', scope.$destroy);\n\t\t\t\t\tscope.$once('$destroy', function () {\n\t\t\t\t\t\twrappedEl.off('$destroy', scope.$destroy);\n\t\t\t\t\t\twrappedEl.removeClass('scope-linked').triggerHandler(\"$compile.removeScope\"); \n\t\t\t\t\t\tsetCompilerData(el, '$scope', null);\n\t\t\t\t\t});\n\t\t\t\t\twrappedEl.addClass('scope-linked'); \n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (compilingThisElement) {\n\t\t\t\t\tsetCompilerData(el, '$directives', existingDirectives.concat(matchingDirectives));\n\t\t\t\t\tscope.$once('$destroy', function () { setCompilerData(el, '$directives', null) });\n\t\t\t\t\twrappedEl.triggerHandler(\"$compile.end\"); \n\t\t\t\t}\n\t\t\t\treturn scope;\n\t\t\t}\n\t\t\t\n\t\t\tfunction linkDirectiveToNode(directive) {\n\t\t\t\tvar directiveData = elementData,\n\t\t\t\t\tdirectiveController;\n\t\t\t\tif (typeof directive.data === \"function\") {\n\t\t\t\t\tdirectiveData = util.objectAssign({}, directive.data(wrappedEl, scope), elementData);\n\t\t\t\t} else if (typeof directive.data === \"object\") {\n\t\t\t\t\tdirectiveData = util.objectAssign({}, directive.data, elementData);\n\t\t\t\t}\n\t\t\t\tif (typeof directive.controller === \"function\") {\n\t\t\t\t\tdirectiveController = provider.instantiate(directive.controller, {$scope: scope});\n\t\t\t\t} else if (typeof directive.controller === \"string\") {\n\t\t\t\t\tdirectiveController = provider.controller(directive.controller, null, {$scope: scope});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttry{\n\t\t\t\t\tdirective.link(wrappedEl, scope, directiveData, directiveController);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Error compiling: ', e);\t// TODO: Something?\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif (!scope.$deferCompile) {\n\t\t\t\tscope.$deferCompile = function (promise) { \n\t\t\t\t\tif (promise && promise.then === \"function\") compileDefer.push(promise); \n\t\t\t\t};\n\t\t\t}\n\t\t\t\n\t\t\tif (compilingThisElement) {\n\t\t\t\twrappedEl.triggerHandler(\"$compile.start\");\n\t\t\t\tmatchingDirectives.forEach(linkDirectiveToNode);\n\t\t\t}\n\t\t\t\n\t\t\tif (!terminal) {\n\t\t\t\tArray.prototype.slice.call(el.childNodes).forEach(function compileNode(child) { \n\t\t\t\t\tscope.$deferCompile( compiler.compile(child, scope, null, false, true) );\n\t\t\t\t}, compiler);\n\t\t\t}\n\t\t\t\n\t\t\tif (autoCompile && !compileDefer.length) endCompileNode();\n\t\t\telse return Promise.all(compileDefer).then(endCompileNode);\n\t\t};\n\t}\n\t\n\n\tfunction DirectiveTester(name) {\n\t\tthis.name = name;\t\t\t\t\t\t\t// Should not have spaces here\n\t\tthis.nameSanitized = this.name.replace(/[^0-9a-zA-Z-_]/g, '');\n\t\tthis.nameDashed = this.nameSanitized.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n\t\tvar tests = [];\n\t\t\n\t\tif (this.name.indexOf('.')===0) {\t\t\t// Matches Class\n\t\t\tvar classRegEx = new RegExp(' '+ this.name.slice(1) +' ');\n\t\t\ttests.push(function checkClass(el) { \n\t\t\t\treturn (' '+ el.className +' ').indexOf(' '+ this.nameSanitized +' ') > -1;\n\t\t\t});\n\t\t} else if (this.name.indexOf('#')===0) {\t// Matches Id\n\t\t\tvar idTest = this.name.slice(1);\n\t\t\ttests.push(function checkId(el) { return el.getAttribute('id')===idTest });\n\t\t} else {\n\t\t\ttests.push(function checkAttribute(el) {\n\t\t\t\treturn el.nodeName.toLowerCase() === this.nameDashed\t// Matches Tag\n\t\t\t\t\t\t|| el.hasAttribute(this.nameSanitized)  \t\t// Matches attribute\n\t\t\t\t\t\t|| el.hasAttribute(this.nameDashed)\n\t\t\t\t\t\t|| el.hasAttribute('data-'+this.nameDashed);\t// Matches data attribute\n\t\t\t});\n\t\t}\n\t\t\n\t\tthis.test = function runAllTests(el) {\n\t\t\tif (el.tagName) {\t\t\t\t// node.nodeType === 1 || node.nodeType === 11\n\t\t\t\tfor(var i=0; i < tests.length; i++)\n\t\t\t\t\tif (tests[i].call(this, el)) return true;\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t}\n\n\tfunction diff(A, B) {\n\t\treturn A.filter(function (x) { return B.indexOf(x) < 0; });\n\t}\n\t\t\n\tfunction requiresScope(directives) { \n\t\treturn directives.filter(function(directive) {return directive.scope;}).length\n\t}\n\n\tfunction requiresIsolateScope(directives) { \n\t\treturn directives.filter(function(directive) {return typeof directive.scope === \"object\";}).length\n\t}\n\t\t\n\tfunction getCompilerData(el, prop) { \n\t\treturn el[compilerId]? el[compilerId][prop] : null; \n\t}\n\t\n\tfunction setCompilerData(el, prop, val) {\n\t\tif (!el[compilerId]) el[compilerId] = {};\n\t\tel[compilerId][prop] = val;\n\t}\n\t\n\tfunction getScope(element) {\n\t\treturn getCompilerData(element, '$scope') || getScope(element.parentNode);\n\t}\n\t\t\n\treturn Compiler;\n})(\n\t'$$compiler'+(Math.random() * 10921), \n\tjQuery || Zepto, \n\trequire(\"../utilities/pLitr.js\"), \n\trequire(\"../utilities/Util.js\")\n);\n\nif (typeof module !== 'undefined' && module.exports) module.exports = Compiler;\nif (typeof define == 'function' && define.amd) define(function(){ return Compiler; });","/** \n * @class Provider\n *\n * @description \n *\t\tRegister and provide components.\n *\t\tComponents can be `directive`, `controller` or `service`.\n *\t\tA component must be registered using the function of corresponding name.\n *\t\tOnce registered a component can be accessed using the function of corresponding name.\n *\t\tAll components must be registered as a provider function, which returns component.\n *\t\tRegistered components can be aliased. The alias method accepts an `extend` function which \n *\t\tmodify the aliased component.\n *\n *\t\tArray of dependencies should be added to provider function as static property named `$dependencies`, \n *\t\tto avoid problems when minified.\n *\t\t\n *\t\tWhen providing a service or controller, the provider will instantiate provider. \n *\t\tThis instance will cached if a `$cache` property is present on the provider.\n *\t\t\n *\t\tDirective providers must return a function or object which contains a `link` property \n *\t\twhich is a function.\n *\t\tDirectives are invoked normally, but the result is cached by default unless `$cache === false`.\n * \n * @example \n \t\t`var directiveProvider = function (aDependency) {\n\t\t \treturn {\n\t\t\t\tscope: true,\n\t\t\t\tcontroller: \"aController\",\n\t\t\t\tlink: function ($scope, $element) {\n\t\t\t\t\taDependency.doSomethingWith($element);\n\t\t\t\t}\n\t\t\t};\n\t\t };\n\t\t directiveProvider.$dependencies = [\"aDependency\"];\n\t\t \n\t\t var $provider = new Provider();\n\t\t $provider.directive(\"directiveName\", directiveProvider);\n\t\t $provider.controller(\"aController\", function conrollerProvider() {this.x = function y(){};});\n\t\t $provider.service(\"aDependency\", function dependencyProvider() {return dependency;});\n\t\t \n\t\t $provider.alias(\"directiveName\", \".someSelector\");\n\t\t $provider.alias('mainView', 'otherView', function (directive) {\n\t\t\t\tvar data = directive.data;\n\t\t\t\tdirective.data = function ($element) {\n\t\t\t\t\treturn Object.assign({}, data, {mainView: $element.data('other-view')});\n\t\t\t\t};\n\t\t\t\treturn directive;\n\t\t\t});\n\t\t \n\t\t var directive = $provider.directive(\"differentDirectiveName\");`\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nvar Provider = (function (undefined) {\n\t'use strict';\n\t\n\tvar DIRECTIVE_SUFFIX = ' _DIRECTIVE_',\n\t\tCONTROLLER_SUFFIX = ' _CONTROLLER_';\n\t\t\n\tfunction extractParamNames(fn) {\n\t\tvar params= fn.toString().replace(/((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg, '').match(/\\((.*?)\\)/);\n\t\tif (params && params[1]) return params[1].split(',').map(function (p) { return p.trim(); });\n\t\telse return [];\n\t}\n\n\tfunction construct(constructor, args) {\n\t\tfunction C() { return constructor.apply(this, args); }\n\t\tC.prototype = constructor.prototype;\n\t\treturn new C();\n\t}\n\t\n\t\n\tfunction Provider(_components_) {\n\t\tvar provider = this,\n\t\t\tproviders = {},\n\t\t\tcache = {$$directiveSelectors: []};\n\t\n\t\t/* Dependency names must be attched to class using static $dependencies array: \n\t\t\t`function myService(){}; myService.$dependencies = [\"aDependencyName\"];` */\n\t\tfunction getDependencies(f, locals) {\n    \t\tlocals = locals || {};\n\t\t\treturn (Array.isArray(f.$dependencies)? f.$dependencies : extractParamNames(f))\n\t\t\t\t\t.map(function (s) { return locals[s] || provider.service(s, null, locals) });\n\t\t}\n\t\n\t\t/* Do not allow providers to be replaced */\n\t\tfunction checkSecurity(name) { \t\t\t\t\n\t\t\tif (providers[name]) throw new Error(\"Provider already exists: \"+name);\n\t\t\treturn name;\n\t\t}\n\t\t\n\t\t\n\t\tthis.directive = function (name, fn, locals) {\n\t\t\t/* Return directive list if no args */\n\t\t\tif (!arguments.length) return cache.$$directiveSelectors;\n\t\t\t\n\t\t\tvar directiveName = name + DIRECTIVE_SUFFIX;\t\n\n\t\t\t/* Provide directive when fn omitted */\n\t\t\tif (name && !fn) {\n\t\t\t\tvar providr = providers[directiveName],\n\t\t\t\t\tcached = cache[directiveName];\n\t\t\t\tif (typeof cached !== 'undefined') return cached;\n\t\t\t\tif (!providr) return;\n\t\t\t\tcached = provider.invoke(providr, locals);\n\t\t\t\tif (typeof cached === \"function\") cached = {link: cached};\n\t\t\t\treturn cache[directiveName] = cached;\n\t\t\t}\n\t\t\t\n\t\t\tcheckSecurity(directiveName);\n\n\t\t\t/* Register directive */\n\t\t\tproviders[directiveName] = fn;\n\t\t\tcache.$$directiveSelectors.push(name);\n\t\t\treturn this;\n\t\t};\n\t\t\n    \tthis.controller = function (name, fn, locals) {\n\t\t\tvar controllerName = name + CONTROLLER_SUFFIX;\n\n\t\t\t/* Provide controller when fn omitted */\n\t\t\tif (name && !fn) {\n\t\t\t\tvar providr = providers[controllerName];\n\t\t\t\tif(providr) return provider.instantiate(providr, locals);\n\t\t\t\telse return;\n\t\t\t}\n\t\t\t\n\t\t\tcheckSecurity(controllerName);\n\n\t\t\t/* Register controller */\n\t\t\tproviders[controllerName] = fn;\n\t\t\treturn this;\n    \t};\n\t\t\n\t\tthis.service = function (name, fn, locals) {\n\t\t\tif (name && !fn) {\n\t\t\t\t/* Provide service when fn omitted */\n\t\t\t\tvar providr = providers[name],\n\t\t\t\t\tcached = cache[name];\n\n\t\t\t\tif (typeof cached !== 'undefined'){\n\t\t\t\t\treturn cached;\n\t\t\t\t} else if (typeof providr === 'function') {\n\t\t\t\t\tvar service = provider.instantiate(providr, locals);\n\t\t\t\t\tif(providr.$cache !== false) cache[name] = service;\n\t\t\t\t\treturn service;\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else if(checkSecurity(name)) {\n\t\t\t\t/* Register service */\n\t\t\t\tproviders[name] = fn;\n\t\t\t}\n\t\t\treturn this;\n    \t};\n\t\t\n\t\t\n\t\tthis.invoke = function (fn, locals) {\n\t\t\treturn fn.apply(null, getDependencies(fn, locals));\n\t\t};\n\t\t\n    \tthis.instantiate = function (fn, locals) {\n\t\t\treturn construct(fn, getDependencies(fn, locals));\n    \t};\n\t\t\n\t\tthis.alias = function (name, alias, extendFn) {\n\t\t\tvar hasAlias;\n\t\t\t\n\t\t\tfunction aliasType(_type_) {\n\t\t\t\tvar originalDirective = provider[_type_](name);\n\t\t\t\tif (originalDirective === undefined) return;\n\n\t\t\t\thasAlias = provider[_type_](alias, function () {\n\t\t\t\t\tif (typeof extendFn === \"function\")\n\t\t\t\t\t\treturn extendFn(Object.create(originalDirective));\n\t\t\t\t\telse\n\t\t\t\t\t\treturn originalDirective;\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t[\"service\", \"directive\", \"controller\"].forEach(aliasType);\n\t\t\t\n\t\t\tif (!hasAlias) throw new Error(name+\" has not been provided.\");\n\t\t\treturn provider;\n\t\t};\n\t\n\t\tif (_components_)\n\t\t\t'directive controller service'.split(' ')\n\t\t\t\t.forEach(function (providerName) {\n\t\t\t\t\tfor (var componentName in _components_[providerName])\n\t\t\t\t\t\tprovider[providerName](componentName, _components_[providerName][componentName]);\n\t\t\t\t});\n\t}\n\t\n\treturn Provider;\n}());\n\nif (typeof module !== 'undefined' && module.exports) module.exports = Provider;\nif (typeof define == 'function' && define.amd) define(function(){ return Provider });","/** \n * @class controller\n * @constructs directive\n * @description Create scope and instantiate a controller. Optionally attach to scope.\n *  \n * @param {String} controller name of controller (Controller must be provided to app);\n * @param {String} controllerAs name of variable to add to scope as controller;\n *\n * @example \n\t\t`<body>\n\t\t\t\t<header data-controller=\"headerController\" controller-as=\"cx\">\n\t\t\t\t\t<button on-interaction=\"click\" execute-on-scope=\"cx.clickFn\" />\n\t\t\t\t</header>\n\t\t\t\t<div>\n\t\t\t\t\t// ...\n\t\t\t\t</div>\n\t\t\t\t<footer />\n\t\t </body>`\n *\n * @requires $app<ARENA>\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\t\nfunction controllerDirective($app) {\n\treturn {\n    scope: true,\n\t\tdata: {\n\t\t\tcontroller: undefined,\n\t\t\tcontrollerAs: undefined,\n\t\t},\n    link: function ($element, $scope, data) {\n\t\t\tvar contoller;\n\t\t\tif ($app.isFunction(data.controller)) {\n\t\t\t\tcontoller = $app.$provider.instantiate(data.controller, {$scope: $scope});\n\t\t\t} else if ($app.isString(data.controller)) {\n\t\t\t\tcontoller = $app.$provider.controller(data.controller, null, {$scope: $scope});\n\t\t\t}\n\t\t\tif (contoller && $app.isString(data.controllerAs)) \n\t\t\t\t$scope[data.controllerAs] = contoller;\t\t\n    }\n  };\n}\ncontrollerDirective.$dependencies = [\"$app\"];\n\nif (typeof module !== 'undefined' && module.exports) module.exports = controllerDirective;","/** \n * @class MainView\n * @constructs directive\n * @description Use ajax to update part of your page. \n *    When Links are clicked within the linked element, a new route is requested with \n * \t\tthe target being main-view target.\n *    When route has been resolved, main-view target is replaced.\n *\t\tThe mainView target should have a scope so it can be safely $destroyed without \n * \t\tleaving behind orphaned scopes; if it does not, one will be created.\n *    and compiled with that of the page at new route. \n *\t\tThe page must contain an element matching the main-view target selector.\n *    The http GET response must contain an element matching the main-view target selector.\n *\n * @param {String} mainView Target element selector. Default: \"body\";\n * @param {Boolean} changeAppRoute Allow $app to change route when updating target content. Default: true;\n * @param {Boolean | Function} scrollTo Scroll to target on update. Default: true;\n * @param {String} linkSelector Only matching links will trigger update. Default: 'a,[ajax-href]';\n * @param {String} linkFilter Matching links will not trigger update. Default: '.ajax-ignore';\n * @param {String} loadingClass Class added to linked element during update. Default: 'view-loading';\n * @param {String} targetLoadingClass Class added to target (and replacement) during update. Default: 'ajax-loading';\n *\n * @fires $scope#$viewLoading - {request: {requesteObject}}\n *\t\t\t\t\t\t- $broadcasted when new route requested with this target\n * @fires $scope#$viewLoaded - {request: {requesteObject}, response: {responseObject}}\n *\t\t\t\t\t\t- $broadcasted when new route resolved with this target\n * @fires $scope#$viewExit - {$target: {Element}[, $replacement: {Element}]} \n *\t\t\t\t\t\t- $broadcasted when view about to be replaced\n * @fires $scope#$viewEnter - {$target: {Element}}\n *\t\t\t\t\t\t- $broadcasted when view has been replaced\n * \n * @example \n\t\t`<body main-view=\"#target\">\t//Links in here will update #target\n\t\t\t\t<header>\n\t\t\t\t\t<nav />\n\t\t\t\t</header>\n\n\t\t\t\t<main id=\"target\" controller=\"view-controller\">\n\t\t\t\t\t// This content updated via xhr\n\t\t\t\t\t<section other-view=\"[other-view]\">\n\t\t\t\t\t\t// This content also updated via xhr but controlled separately\n\t\t\t\t\t</section>\n\t\t\t\t</main>\n\n\t\t\t\t<footer />\n\t\t \n\t\t\t\t<script>\n\t\t\t\t\tvar APP = new ARENA('YOUR APP');\n\t\t\t\t\tAPP.$provider.alias('mainView', 'otherView', function (directive) {\n\t\t\t\t\t\tvar data = directive.data;\n\t\t\t\t\t\tdirective.data = function ($element) {\n\t\t\t\t\t\t\treturn Object.assign({}, data, {mainView: $element.data('other-view')});\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn directive;\n\t\t\t\t\t});\n\t\t\t\t</script>\n\t\t </body>`\n *\n * @requires $<jQuery>\n * @requires $app\n * @requires $router\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\t\n\t\nfunction mainViewDirective($, $app, $router, $window, $rootElement) {\n\tvar ROOT_VIEW, \n\t\t\tACTIVE_VIEWS = {};\n\treturn {\n    scope: true,\n\t\tdata: {\n\t\t\tmainView: 'body',\n\t\t\tscrollTo: true,\n\t\t\tcssTransitions: false,\n\t\t\tchangeAppRoute: true,\n\t\t\tlinkSelector: 'a,[ajax-href]',\n\t\t\tlinkFilter: '.ajax-ignore',\n\t\t\trequestMethod: 'GET',\n\t\t\trequestHeaders: undefined,\n\t\t\tloadingClass: 'view-loading',\n\t\t\ttargetLoadingClass: 'ajax-loading',\n\t\t\terrorPage: '/404',\n\t\t\tonServerError: function (e, request) {\n\t\t\t\tif (window.confirm(\"There has been a server error, do you want to reload the page?\"))\n\t\t\t\t\twindow.location.replace(request.url)\n\t\t\t}\n\t\t},\n    link: function ($element, $scope, data) {\n\t\t\tvar updateTarget, $target = $rootElement.find(data.mainView);\n\t\t\tif (!$target.length) return;\n\t\t\telse if (!$target.data(\"controller\")) $target.attr(\"controller\", 'mainViewTarget');\n\n\t\t\tif ($app.$browser.historyAPI && $app.$config.html5Mode && data.changeAppRoute) {\n\t\t\t\tupdateTarget = $app.viewUpdater($app, $scope, $element, $target);\n\t\t\t\tsetInitialState();\n\t\t\t\n\t\t\t\t$element.on(\"$compile.end\", function () {\n\t\t\t\t\t$window.on('popstate', handleStateChange);\n\t\t\t\t\t$element.on('click', data.linkSelector, handleClicks);\n\t\n\t\t\t\t\t$scope.$on(\"$destroy\", function () {\n\t\t\t\t\t\tif (ACTIVE_VIEWS[data.mainView]) ACTIVE_VIEWS[data.mainView] = undefined;\n\t\t\t\t\t\tif (ROOT_VIEW === data.mainView) ROOT_VIEW = undefined;\n\t\t\t\t\t\t$window.off('popstate', handleStateChange);\n\t\t\t\t\t\t$element.off('click', data.linkSelector, handleClicks);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction setInitialState() {\n\t\t\t\tACTIVE_VIEWS[data.mainView] = {triggerElement: $element};\n\t\t\t\tif (ROOT_VIEW && window.history.state && window.history.state.$$ARENA) return; \n\t\t\t\twindow.history.replaceState(buildStateObject({}, document.title), document.title, window.location.href);\n\t\t\t\tROOT_VIEW = data.mainView;\n\t\t\t}\t\n\n\t\t\tfunction buildStateObject(options, title) {\n\t\t\t\tvar state = {$$ARENA: $app.$config.name, title: title};\n\t\t\t\tstate.targetElement = options.targetElement || data.mainView;\n\t\t\t\tstate.method = options.requestMethod || data.requestMethod;\n\t\t\t\tstate.data = options.requestData || data.requestData;\n\t\t\t\tstate.headers = options.requestHeaders || data.requestHeaders;\n\t\t\t\treturn state;\n\t\t\t}\n\t\t\t\n\t\t\tfunction handleClicks(event) {\n\t\t\t\tvar $this, clickData,\n\t\t\t\t\t\trequest = {changeAppRoute: data.changeAppRoute};\n\t\t\t\t\n\t\t\t\tif (event.which == 2 || event.metaKey || ($this = $(this)).is(data.linkFilter))\n\t\t\t\t\treturn true;\n\t\t\t\t\n\t\t\t\tclickData = $this.data();\n\t\t\t\t\n\t\t\t\trequest.url = $this.attr('href') || clickData.ajaxHref;\n\t\t\t\tif (request.url.indexOf(\"#\") === 0) return true;\t\n\t\t\t\tif (request.url == window.location.pathname) return false;\t\n\t\t\t\tif (!$router.isValidRoute(request.url)) return true;\t\n\t\t\t\t\n\t\t\t\tif ($app.isDefined(clickData.changeAppRoute)) \n\t\t\t\t\trequest.changeAppRoute = clickData.changeAppRoute;\t\n\t\t\t\t\n\t\t\t\tif ($app.isFunction(clickData.ajaxRequestCallback)) \n\t\t\t\t\trequest.callback = clickData.ajaxRequestCallback;\n\t\t\t\t\n\t\t\t\trequest.state = buildStateObject(clickData, request.title);\n\t\t\t\t\n\t\t\t\tif (request.changeAppRoute && !($app.$browser.historyAPI && $app.$config.html5Mode)) \n\t\t\t\t\treturn true;\n\t\t\t\t\n\t\t\t\tevent.preventDefault();\n\t\t\t\tif (ROOT_VIEW !== data.mainView) event.stopPropagation();\t\t//Only handle clicks once\n\t\t\t\tupdateTarget(request, data);\n\t\t\t}\n\t\t\t\n\t\t\tfunction handleStateChange(event) {\n\t\t\t\tif (!event.originalEvent.state) return;\n\t\t\t\tvar targetView = event.originalEvent.state.targetElement;\n\t\t\t\t\n\t\t\t\t//Root view must handle odd cases\n\t\t\t\tif (ROOT_VIEW === data.mainView && (!targetView || !ACTIVE_VIEWS[targetView] || !$(targetView).length))\n\t\t\t\t\t\ttargetView = event.originalEvent.state.targetElement = ROOT_VIEW;\n\t\t\t\t\n\t\t\t\tif (targetView === data.mainView) {\n\t\t\t\t\t\tupdateTarget({\n\t\t\t\t\t\t\tstate: event.originalEvent.state, \n\t\t\t\t\t\t\ttitle: event.originalEvent.state.title, \n\t\t\t\t\t\t\turl: (window.location.pathname+window.location.search)\n\t\t\t\t\t\t}, data);\n\t\t\t\t}\n\t\t\t}\t\n    }\n  }\n}\nmainViewDirective.$dependencies = [\"$\", \"$app\", \"$router\", \"$window\", \"$rootElement\"];\n\nif (typeof module !== 'undefined' && module.exports) module.exports = mainViewDirective;\n","/** \n * @class RouterService\n * @description Using window.location and window.history,\n * \tserves as router and a URL/Location/History api. \n *\n * @fires $app#$routeChange \n * \t\t\t\t- {request: {requesteObject}}\n *\t\t\t\t- when new route changed\n * @fires $app#$routeChange.start \n * \t\t\t\t- {request: {requesteObject}, response: {responseObject}}\n *\t\t\t\t- when route is about to be changed by http request\n * @fires $app#$routeChange.end \n * \t\t\t\t- {request: {requesteObject}[, response: {responseObject} | error: {errorObject}]} \n *\t\t\t\t- when route has been changed by a http request\n * \n * @example\n\t\t`$router.blacklist('/a/path');\t\t\t\t// \"/a/path\" will be ignored\n\t\t $('a').on('click', function (e) {\n\t\t \t\tvar path = this.href;\n\t\t\t\tif ($router.isValidRoute(path)) {\t// False if path starts with \"/a/path\"\n\t\t\t\t\tvar request = {\n\t\t\t\t\t\t url: path,\n\t\t\t\t\t\t state: {\n\t\t\t\t\t\t\t targetElement: '[main-view]';\n\t\t\t\t\t\t\t method: \"GET\";\n\t\t\t\t\t\t\t data: {g: 'thang'}\n\t\t\t\t\t\t }\n\t\t\t\t\t };\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\t$router.navigate({url: path});\n\t\t\t\t\t$router.get(request)\n\t\t\t\t\t .then(function (response) {\n\t\t\t\t\t\t $(request.state.targetElement).replaceWith(response.data.targetHtml);\n\t\t\t\t\t });\n\t\t\t\t}\n\t\t });`\n *\n * @requires $<jQuery>\n * @requires $app<ARENA>\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nfunction routerProvider($, $app) {\n\t\n\tfunction RouterService() {\n\t\tvar router = this, \n\t\t\t_blacklist_ = [];\n\t\trouter.base = \"/\";\n\t\trouter.isInternalRoute = function (path) {\n\t\t\treturn path.substring(0, router.base.length) === router.base\n\t\t\t\t\t|| path.indexOf(':') === -1;\n\t\t};\n\t\trouter.isValidRoute = function (path) {\n\t\t\tif (!router.isInternalRoute(path)) return false;\n\t\t\tfor (var l = _blacklist_.length, i = (path === router.base) ? l + 1 : 0; i < l; i++)\n\t\t\t\tif (path.indexOf(_blacklist_[i]) === 0) return false;\n\t\t\treturn true;\n\t\t};\n\t\trouter.blacklist = function (paths) { \n\t\t\tif (Array.isArray(paths)) _blacklist_ = _blacklist_.concat(paths);\n\t\t\telse _blacklist_.push(paths);\n\t\t};\n\t}\n\t\n\tRouterService.prototype.evalHtmlResponse = function (html, targetSelector, skipSanitization) {\n\t\tvar data = {html: html};\n\t\tif (!skipSanitization) data.sanitizedHtml = getDocumentHtml(html, true);\n\t\tvar $html = $('<div>'+ (data.sanitizedHtml || html) +'</div>');\n\t\tdata.metaData = getDocumentMeta($html);\n\t\tdata.targetHtml = $html.find(targetSelector).get(0);\n\t\tdata.scripts = getDocumentScript(html);\n\t\t$html = null;\n\t\treturn data;\n\t};\n\t\n\tRouterService.prototype.navigate = function (request) {\n\t\t$app.$trigger({type: '$routeChange', request: request});\n\t\t\n\t\tif (!$app.$browser.historyAPI || !$app.$config.html5Mode)\n\t\t\treturn window.location.href = request.url;\n\n\t\twindow.history.pushState(request.state, request.title, request.url);\t\n\t\trequest.title && $app.updatePageTitle(request.title);\n\t};\n\t\n\tRouterService.prototype.ajax = function (request) {\n\t\treturn new $app.Promise(function (resolve, reject) {\n\t\t\t$.ajax({\n\t\t\t\turl: request.url,\n\t\t\t\tdata: request.data,\n\t\t\t\ttype: request.method,\n\t\t\t\theaders: request.headers,\n\t\t\t\tsuccess: function (data, textStatus, jqXHR) {\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tdata: data,\n\t\t\t\t\t\trequest: request,\n\t\t\t\t\t\ttextStatus: textStatus,\n\t\t\t\t\t\tjqXHR: jqXHR\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\terror: function (jqXHR, textStatus, errorThrown) {\n\t\t\t\t\treject(jqXHR);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t};\n\t\n\tRouterService.prototype.http = function (request) {\n\t\tvar router = this;\n\t\t\n\t\tif (request.changeAppRoute) {\n\t\t\t$app.$trigger({type: '$routeChange.start', request: request});\n\t\t\trouter.navigate(request);\n\t\t}\n\t\t\n\t\tfunction onSuccess(response) {\n\t\t\tif (request.state.targetElement) {\n\t\t\t\tvar dataEval = router.evalHtmlResponse(response.data, request.state.targetElement);\n\t\t\t\tif (!dataEval.targetHtml) {\n\t\t\t\t\tvar e = new Error('The target html \"'+request.state.targetElement+'\" was not found.');\n\t\t\t\t\te.status = 500;\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t\tresponse.data = dataEval;\n\t\t\t\tif (!request.title && dataEval.metaData && dataEval.metaData.title)\n\t\t\t\t\t$app.updatePageTitle(dataEval.metaData.title);\n\t\t\t}\n\t\t\tif (request.changeAppRoute)\n\t\t\t\t$app.$trigger({type: '$routeChange.end', request: request, response: response});\n\t\t\treturn response;\n\t\t}\n\t\tfunction onError(error) {\n\t\t\tif (request.changeAppRoute)\n\t\t\t\t$app.$trigger({type: '$routeChange.end', request: request, error: error});\n\t\t\treturn $app.Promise.reject(error);\n\t\t}\n\n\t\treturn router.ajax(request).then(onSuccess).catch(onError);;\n\t};\n\t\n\treturn new RouterService();\n}\nrouterProvider.$dependencies = [\"$\", \"$app\"];\n\n\nfunction getDocumentScript(_html_) { \n\treturn _html_.match(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi) \n}\n\nfunction getDocumentMeta($html) {\n\treturn {\n\t\ttitle: decodeURI($html.find('.document-title:first').text()||\"\")\n\t};\t// TODO: get more meta...\n}\n\nfunction getDocumentHtml(html, sanitize) {\n\tvar result = String(html);\n\tif (!result.length) return;\n\tif (sanitize) {\n\t\tif (-1 === result.indexOf('<html')) {\n\t\t\tresult = '<html><head></head><body>' + result + '</body></html>';\n\t\t}\n\t\tresult = result.replace(/<\\!DOCTYPE[^>]*>/i, '')\n\t\t\t.replace(/<(html|head|body|title|meta|link)([\\s\\>])/gi, '<div class=\"document-$1\"$2')\n\t\t\t.replace(/<\\/(html|head|body|title|meta|link)\\>/gi, '</div>')\n\t\t\t.replace(/<script/gi, ' <!-- <script')\n\t\t\t.replace(/\\/script>/gi, '/script> --> ');\n\t}\n\treturn result.trim();\n}\n\nif (typeof module !== 'undefined' && module.exports) module.exports = routerProvider;","/** \n * @class Scope\n *\n * @description \n *\t\tCreate an application model/context for views and controllers.\n *\t\tAll scopes are eventDispatches.\n *\t\tScopes can be nested, with parents available as $scope.$parent, and array of child scopes \n *\t\tas $scope.$children.\n * \n * @example\n \t\t`var $rootScope = new Scope();`\n *\n * @method $create Create a new scope\n *\t\t`var $rootScope = new Scope();\t\t\t\t// Has no parent. Cannot be $destroy(ed)\n *\t\t var $childScope = $rootScope.$create();`\t// Child of rootscope. Can be destroyed\n *\n * @method $emit Trigger an event on a scope and all it's decendants\n *\t\t`$childScope.$on('someEvent'); \n *\t\t $rootScope.$emit(event);`\t\t\t\t\t// $child will dispatch someEvent\n * \n * @method $broadcast Trigger an event on a scope and all it's ancestors\n *\t\t`$rootScope.$on('someEvent'); \n *\t\t $childScope.$broadcast(event);`\t\t\t// $rootScope will dispatch someEvent\n *\n * @method $destroy Destroy a scope\n *  `$childScope.$destroy();\n *   $childScope.$trigger('someEvent');`\t\t\t// Does nothing because scope is destroyed\n *\n * @fires $scope#$destroy\n *\t\t- when $destroy function is called.\n *\n * @requires makeEventDispatch\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nvar Scope = (function (makeEventDispatch) {\n\t'use strict';\n\t\n\tfunction Scope(parent, callback) {\n\t\tvar scope = makeEventDispatch(this),\n\t\t\tid = (parent && parent.$children? parent.$children.length : 0).toString();\n\t\tthis.$id = (parent && parent.$id)? parent.$id+\".\"+id : id;\n\t\t\n\t\tif (parent) {\n\t\t\tthis.$parent = parent;\n\t\t\tparent.$children.push(scope);\n\t\t}\n\t\tthis.$children = [];\n\t\t\n\t\tfunction createScope(isolate, callback) {\n\t\t\tvar newScope;\n\t\t\t\n\t\t\tif (isolate) {\n\t\t\t\tnewScope = new Scope(scope, callback);\n\t\t\t} else {\n\t\t\t\tvar S = function(){ return Scope.call(this, scope, callback); };\n\t\t\t\tS.prototype = scope;\n\t\t\t\tnewScope = new S();\n\t\t\t}\n\t\t\t\n\t\t\tif (!newScope.$root) \n\t\t\t\tnewScope.$root = scope.$root || scope;\n\t\t\treturn newScope;\n\t\t}\n\n\t\tfunction destroyScope() {\n\t\t\tif (!scope.$parent) return;\t\t\t\t\t// $rootScope is always indestructible\n\t\t\telse scope.$trigger(\"$destroy\");\n\t\t\t\n\t\t\tfor (var c = scope.$children.length; c; c--) \n\t\t\t\tscope.$children[c-1].$destroy();\n\n\t\t\tvar siblings = scope.$parent.$children;\n\t\t\tsiblings.splice(siblings.indexOf(scope), 1);\n\t\t\tscope.$destroyDispatch();\t\t\t\t\t// End all event listeners\n\t\t\tscope.$parent = scope.$root = scope.$$watchers = null;\n\t\t\tscope.$destroyed = true;\n\t\t}\n\n\t\tfunction emitEvent(e) {\n\t\t\tif (!e.stopPropagation) \n\t\t\t\ttry{\n\t\t\t\t\te.stopPropagation = function () { e.__propagationStopped__ = true; };\n\t\t\t\t} catch (e) {}\n\t\t\tscope.$trigger(e);\n\t\t\tscope.$children.forEach(function (childScope) {\n\t\t\t\tif (!e.__propagationStopped__) childScope.$emit(e);\n\t\t\t});\n\t\t\treturn scope;\n\t\t}\n\n\t\tfunction broadcastEvent(e) {\n\t\t\tif (!e.stopPropagation) \n\t\t\t\ttry {\n\t\t\t\t\te.stopPropagation = function () { e.__propagationStopped__ = true; };\n\t\t\t\t} catch (e) {}\n\t\t\tscope.$trigger(e);\n\t\t\tif (scope.$parent && !e.__propagationStopped__) \n\t\t\t\tscope.$parent.$broadcast(e);\n\t\t\treturn scope;\n\t\t}\n\t\t\n\t\tthis.$create = createScope;\n\t\tthis.$destroy = destroyScope;\n\t\tthis.$emit = emitEvent;\n\t\tthis.$broadcast = broadcastEvent;\n\t\t\n\t\tif (typeof callback === \"function\") callback(this);\n\t}\n\t\n\t//TODO: dirty checking - $digest option???\n\treturn Scope;\n})(require(\"../utilities/makeEventDispatch.js\"));\n\nif (typeof module !== 'undefined' && module.exports) module.exports = Scope;\nif (typeof define == 'function' && define.amd) define(function(){ return Scope; });","/** @class BreakpointMonitor\n *\n * @param {Array} breakpoints object literals {name: screenWidth}\n * @param {Element} DOM element to keep annotated with breakpoint classes\n *\n * @fires breakpointMonitor#viewportBreakpointChanged - Event contains: newBreakpoint {String}, oldBreakpoint {String}\n *\n * @example\n \t\t`breakpointMonitor = new BreakpointManger({mobile: 400, desktop: 1200}, <element>);`\n *\n * @returns a function which tracks and reports on the status of the viewport\n *\n * @method breakpointMonitor.breakpoint(operator<String>, breakpoint<String>);\n \t\t`var isDesktop = breakpointMonitor.breakpoint('>', 'mobile');`\n *\n * @requires $\n * @requires makeEventDispatch\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nvar BreakpointMonitor = (function ($, makeEventDispatch) {\n\tvar $window = $(window);\n\t\n\tfunction testThreshold(breakpoints, operator, breakpointName) {\n\t\tvar w = window.innerWidth || window.clientWidth\n\t\t\t, t = typeof breakpointName == \"string\"? breakpointName : false;\n\n\t\tif (!(t && breakpoints[t])) return false;\n\t\telse t = breakpoints[t];\n\n\t\tif (operator === \">\") return w > t[1];\n\t\tif (operator === \"<\") return w < t[0];\n\t\tif (operator === \">=\") return w >= t[0];\n\t\tif (operator === \"<=\") return w <= t[1];\n\t\telse return (w >= t[0] && w <= t[1]);\n\t}\n\t\n\tfunction annotateElement($element, breakpoint, breakpoints, lastBreakpointClassString) {\n\t\tvar classes = \"\";\n\t\t$element.removeClass(lastBreakpointClassString);\n\t\t$element.addClass(\"viewport-\"+breakpoint);\n\t\tfor (var t in breakpoints) classes += \" viewport-\"+t;\n\t\treturn classes;\n\t}\n\t\n\t\n\tfunction BreakpointMonitor(breakpoints, element) {\n\t\tvar m = makeEventDispatch(this)\n\t\t\t,\tlastBreakpointClassString = \"\";\n\t\t\n\t\tfunction resizeHandler() {\n\t\t\tvar classString = \"\"\n\t\t\t\t, oldBreakpoint = m.currentBreakpoint\n\t\t\t\t, newBreakpoint;\n\t\t\t\n\t\t\tfor (var t in m.breakpoints) {\n\t\t\t\tif (testThreshold(m.breakpoints, '=', t)) newBreakpoint = t;\n\t\t\t}\n\t\t\t\n\t\t\tif (newBreakpoint && newBreakpoint !== oldBreakpoint) {\n\t\t\t\tm.currentBreakpoint = newBreakpoint;\n\t\t\t\t\n\t\t\t\tif (m.$element)\n\t\t\t\t\tlastBreakpointClassString = annotateElement(\n\t\t\t\t\t\tm.$element, newBreakpoint, m.breakpoints, lastBreakpointClassString\n\t\t\t\t\t);\n\t\t\t\t\n\t\t\t\tm.$trigger({\n\t\t\t\t\ttype: \"viewportBreakpointChanged\",\n\t\t\t\t\tnewBreakpoint: newBreakpoint,\n\t\t\t\t\toldBreakpoint: oldBreakpoint\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.breakpoints = breakpoints;\n\t\tif (element) this.$element = element.addClass? element : $(element);\n\t\t\n\t\t/** @method breakpointMonitor.breakpoint(operator<String>, breakpoint<String>);\n\t\t * \t@description Check if the current viewport size is equal to or less/more than one of configured breakpoints \n\t\t * \t@param operator {string} \"more/less than\" or \"equals\"\n\t\t * \t@param breakpoint {string} name of target breakpoint\n\t\t * \t@returns boolean, or name of current breakpoint with no arguments\n\t\t */\n\t\tthis.breakpoint = function (operator, breakpointName) {\n\t\t\tif (!operator && breakpointName) return breakpointName === breakpointName;\n\t\t\treturn breakpointName? testThreshold(m.breakpoints, operator, breakpointName) : m.currentBreakpoint;\n\t\t};\n\t\tthis.refresh = resizeHandler;\n\t\tthis.destroy = function () {\n\t\t\t$window.off('resize', resizeHandler);\n\t\t\tm.$destroyDispatch();\n\t\t};\n\n\t\t$window.on('resize', resizeHandler);\n\t\tthis.refresh();\n\t}\n\n\treturn BreakpointMonitor;\n})(jQuery || Zepto, require(\"./makeEventDispatch.js\"));\n\nif (typeof module !== 'undefined' && module.exports) module.exports = BreakpointMonitor;\nif (typeof define == 'function' && define.amd) define(function(){ return BreakpointMonitor; });","/** @class $cookie: \n *\n * @example\n \t  `$cookie\n\t\t\t.set(<string (name)>, <string (value)>[, <number (days)>, <string (path)>, <string (domain)>, <boolean (secure)>]);`\n * @example\n \t\t`$cookie\n\t\t\t.get(<string (name)>);`\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nvar $cookie = (function () {\n\tfunction set(cookieName, cookieValue, lifeInDays, path, domain, secure) {\n\t\tvar expiryDate\n\t\t\t, today = new Date();\n\t\ttoday.setTime( today.getTime() );\n\t\t\n\t\tif( lifeInDays ) lifeInDays = lifeInDays * 1000 * 60 * 60 * 24;\n\t\texpiryDate = new Date( today.getTime() + (lifeInDays || 0) );\n\t\t\n\t\tdocument.cookie = cookieName \n\t\t\t+ \"=\" +escape( cookieValue ) \n\t\t\t+ ( ( lifeInDays ) ? \";expires=\" + expiryDate.toGMTString() : \"\" ) \n\t\t\t+ \";path=\" + ( path || \"/\" ) \n\t\t\t+ ( ( domain ) ? \";domain=\" + domain : \"\" ) \n\t\t\t+ ( ( secure ) ? \";secure\" : \"\" );\n\t}\n\t\n\tfunction get(cookieName) {\n\t\tif(document.cookie.length > 0){\n\t\t\tvar cookieArray = document.cookie.split(\";\")\n\t\t\t\t, i, l, u, a;\n\t\t\tfor (i = 0, l = cookieArray.length; i < l; i++) {\n\t\t\t\tu = cookieArray[i].substr(0, cookieArray[i].indexOf(\"=\"));\n\t\t\t\ta = cookieArray[i].substr(cookieArray[i].indexOf(\"=\") + 1);\n\t\t\t\tu = u.replace(/^\\s+|\\s+$/g,\"\");\n\t\t\t\tif (u == cookieName) return decodeURI(a);\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn { set: set, get: get };\n})();\n\nif (typeof module !== 'undefined' && module.exports) module.exports = $cookie;\nif (typeof define == 'function' && define.amd) define(function(){ return $cookie; });","/** @class GestureMonitor\n * @description analyses touch events and dispatches swipe events.\n *\n * @param {Element} DOM element to monitor for gestures\n * @param {Object} options object defaults: {\n\t\t\t\t\t\tswipeThreshold: 100,\t\t\t\t// Distance moved before a swipe event can be triggered\n\t\t\t\t\t\ttapThreshold: 150,       \t\t// range of time where a tap event could be detected\n\t\t\t\t\t\tdbltapThreshold: 200,    \t\t// delay needed to detect a double tap\n\t\t\t\t\t\ttapPrecision: 60 / 2,    \t\t// touch events boundaries ( 60px by default )\n\t\t\t\t\t\tjustTouchEvents: false\t\t\t// Disable emulating swipe for mouse\n\t\t\t\t\t}\n *\n * @fires gestureMonitor#swipeUp - Event contains swipe data: {\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toriginalEvent: {Object} touchend event\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n * @fires gestureMonitor#swipeDown - Event contains swipe data\n * @fires gestureMonitor#swipeLeft - Event contains swipe data\n * @fires gestureMonitor#swipeRight - Event contains swipe data\n *\n * @example\n \t\t`var monitor = new GestureMonitor(<element>, {justTouchEvents: true});\n\t\t monitor.$on(\"swipeLeft\", function doSwipeLeftThing() {...});`\n *\n * @method gestureMonitor.destroy remove the monitor\n *\n * @requires $\n * @requires makeEventDispatch\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nvar GestureMonitor = (function ($, makeEventDispatch, util) {  \n  var msPointerEnabled = !!(navigator.msPointerEnabled)\n  \t, pointerEnabled = !!(msPointerEnabled || navigator.pointerEnabled)\n\t\t, msEventType = function (type) { return msPointerEnabled ? 'MS' + type : type.toLowerCase() }\n\t\t, HASTOUCH = pointerEnabled || (!!('ontouchstart' in window) && navigator.userAgent.indexOf('PhantomJS') < 0)\n\t\t,\tTOUCHEVENTS = {\n\t\t\t\ttouchstart: msEventType('PointerDown') + ' touchstart',\n\t\t\t\ttouchend: msEventType('PointerUp') + ' touchend',\n\t\t\t\ttouchmove: msEventType('PointerMove') + ' touchmove'\n      }\n\t\t, OPTIONS = {\n        swipeThreshold: 100,\t\t\t\t// Distance moved before a swipe event can be triggered\n        tapThreshold: 150,       \t\t// range of time where a tap event could be detected\n        dbltapThreshold: 200,    \t\t// delay needed to detect a double tap\n        tapPrecision: 60 / 2,    \t\t// touch events boundaries ( 60px by default )\n        justTouchEvents: false\t\t\t// Disable emulating swipe for mouse\n      };\n\t\n\tfunction getPointerEvent(event) { return event.targetTouches? event.targetTouches[0] : event; }\n\tfunction newTimestamp() { return new Date().getTime(); }\n\tfunction setListener(elm, events, callback) {\n\t\tvar eventsArray = events.split(' ')\n\t\t\t, i = eventsArray.length;\n\t\twhile (i--) \n\t\t\telm.addEventListener(eventsArray[i], callback, false);\n\t}\n  \n\t\n  function SwipeMonitor(element, opt) {\n    var m = makeEventDispatch(this)\n\t\t\t, options = util.objectAssign({}, OPTIONS, opt||{})\n      , tapNum = 0\n\t\t\t, currX, currY, cachedX, cachedY, tapTimer, timestamp, target;\n\t\t\n   if(!document.addEventListener) return this;\n\t\t\n\t\tm.element = $(element);\t\n\t\telement = m.element[0];\n\t\t\n\t\tfunction sendEvent(elm, eventName, originalEvent, data) {\n\t\t\tdata = data || {};\n\t\t\tdata.x = currX;\n\t\t\tdata.y = currY;\n\t\t\tdata.distance = data.distance;\n\t\t\t$(elm).trigger(eventName, data);\n\t\t\tm.$trigger(eventName, data);\n\t\t}\n\t\t\n\t\tfunction onTouchStart(e) {\n\t\t\tvar pointer = getPointerEvent(e);\n\t\t\tcachedX = currX = pointer.pageX;\n\t\t\tcachedY = currY = pointer.pageY;\n\t\t\ttimestamp = newTimestamp();\n\t\t\ttapNum++;\n\t\t}\n\t\t\n\t\tfunction onTouchEnd(e) {\n\t\t\tvar eventsArr = [],\n\t\t\t\tdeltaY = cachedY - currY,\n\t\t\t\tdeltaX = cachedX - currX;\n\n\t\t\tclearTimeout(tapTimer);      // clear the previous timer in case it was set\n\n\t\t\tif(deltaX <= -options.swipeThreshold) eventsArr.push('swipeRight');\n\t\t\tif(deltaX >= options.swipeThreshold) eventsArr.push('swipeLeft');\n\t\t\tif(deltaY <= -options.swipeThreshold) eventsArr.push('swipeDown');\n\t\t\tif(deltaY >= options.swipeThreshold) eventsArr.push('swipeUp');\n\n\t\t\tif(eventsArr.length) {\n\t\t\t\tfor(var i = 0, eventName; i < eventsArr.length; i++){\n\t\t\t\t\teventName = eventsArr[i];\n\t\t\t\t\tsendEvent(e.target, eventName, e, {\n\t\t\t\t\t\tdistance: {\n\t\t\t\t\t\t\tx: Math.abs(deltaX),\n\t\t\t\t\t\t\ty: Math.abs(deltaY)\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(\n\t\t\t\t\t(timestamp + options.tapThreshold) - newTimestamp() >= 0 &&\n\t\t\t\t\tcachedX >= currX - options.tapPrecision &&\n\t\t\t\t\tcachedX <= currX + options.tapPrecision &&\n\t\t\t\t\tcachedY >= currY - options.tapPrecision &&\n\t\t\t\t\tcachedY <= currY + options.tapPrecision\n\t\t\t\t) {          \n\t\t\t\t\t// Here you get the Tap event\n\t\t\t\t\tsendEvent(e.target, (tapNum === 2) && (target === e.target) ? 'dbltap' : 'tap', e);\n\t\t\t\t\ttarget = e.target;\n\t\t\t\t}\n\n\t\t\t\t// reset the tap counter\n\t\t\t\ttapTimer = setTimeout(function(){ tapNum = 0 }, options.dbltapThreshold);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction onTouchMove(e) {\n\t\t\tvar pointer = getPointerEvent(e);\n\t\t\tcurrX = pointer.pageX;\n\t\t\tcurrY = pointer.pageY;\n\t\t}\n    \n    setListener(element, TOUCHEVENTS.touchstart + (options.justTouchEvents ? '' : ' mousedown'), onTouchStart);\n    setListener(element, TOUCHEVENTS.touchend + (options.justTouchEvents ? '' : ' mouseup'), onTouchEnd);\n    setListener(element, TOUCHEVENTS.touchmove + (options.justTouchEvents ? '' : ' mousemove'), onTouchMove);\n  }\n\t\n\t\n//  $.fn['gestureMonitor'] = function(opt){\n//    return this.each(function(index, element){\n//      $.data( this, 'gestureMonitor', new SwipeMonitor(element, opt) );\n//    });\n//  };\n\n\t\n\treturn SwipeMonitor;\n})(jQuery || Zepto, require(\"./makeEventDispatch.js\"), require(\"../utilities/Util.js\"));\n\nif (typeof module !== 'undefined' && module.exports) module.exports = GestureMonitor;\nif (typeof define == 'function' && define.amd) define(function(){ return GestureMonitor; });","/** \n * @class ScrollMonitor\n * @description Listes for browser scroll event and dispatches \"scroll\" event with some useful info.\n *   Provides ElementTracker api for tracking scroll of elements and triggering/subscribing events.\n * \n * @fires scrollMonitor#scroll - Event contains: position ({Number} scroll position), prvPosition (Number), scrollDirection {String} \"down\" or \"up\".\n *\n * @method bind Takes an element and returns an ElementTracker. \n \t\t\t\t\t\t\t\tAccepts {Number} thresholdX/thresholdY parameters for cropping watched area of viewport axes.\n\t\t\t\t\t\t\t\tE.g: `bind(element, 0.5, 0.5)` will treat window as if half its actual size.\n * @method unbind Destroys an ElementTracker produced by this Scrollmonitor.\n * @method destroy Destroys the Scrollmonitor, and any ElementTrackers bound to it.\n * @method scrollTo Scroll to an element: `monitor.scrollTo(element, speed, offset, beforeFn, afterFn)`\n *\n * @requires jQuery\n * @requires MakeEventDispatch\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\t\nvar ScrollMonitor = (function($, makeEventDispatch){\n\tvar $window = $(window)\n\t\t, $htmlBody = $('html, body')\n\t\t, ids = 0\n\t\t, winWidth\n\t\t, winHeight;\n\t\t\n\tfunction updateWindowDimensions() {\n\t\twinWidth = window.innerWidth || window.clientWidth;\n\t\twinHeight = window.innerHeight ||  window.clientHeight;\n\t}\n\t$window.on(\"resize.scrollMonitor\", updateWindowDimensions);\n\tupdateWindowDimensions();\n\t\n\t\n\t/** \n\t * @class ElementTracker\n\t * @description Listens for \"scroll\" event from scrollMonitor and tracks element position relative to viewport.\n\t * \n\t * @param {Element} monitoredElement Element to attach scroll listeners to. Default: window.\n\t * @param {scrollMonitor} scrollMonitor\n\t * @param {element} thresholdX DOM element to track\n\t * @param {Number} thresholdX Change active area of viewport. E.g: 0.5 will treat window as if half its actual width.\n\t * @param {Number} thresholdY Change active area of viewport. E.g: 0.5 will treat window as if half its actual height.\n\t *\n\t * @method checkPosition Checks position and triggers relevant events.\n\t *\n\t * @fires ElementTracker#inView - Fired on scroll, if any part of element is in viewport.\n\t * @fires ElementTracker#outOfView - Fired on scroll, if no part of element is in viewport.\n\t * @fires ElementTracker#enterView - Fired on scroll, if element enters viewport.\n\t * @fires ElementTracker#exitView - Fired on scroll, if element leaves viewport.\n\t * @fires ElementTracker#[top, bottom, left, right]EnterView \n\t *\t\t\t\t\t- Fired on scroll, if an edge of the element enters the viewport.\n\t * @fires ElementTracker#[top, bottom, left, right]ExitView \n\t *\t\t\t\t\t- Fired on scroll, if an edge of the element exits the viewport.\n\t */\n\tfunction ElementTracker(scrollMonitor, element, thresholdX, thresholdY) {\n\t\tvar et = makeEventDispatch(this);\t\n\t\t\n\t\tet.element = element.getBoundingClientRect? element : element[0];\n\t\tet.scrollMonitor = scrollMonitor;\n\t\tif (typeof thresholdX == \"number\") et.thresholdX = thresholdX;\n\t\tif (typeof thresholdY == \"number\") et.thresholdY = thresholdY;\n\t\t\n\t\tet.checkPosition = function (e) { \n\t\t\tvar rect = et.element.getBoundingClientRect()\n\t\t\t\t, elH = rect.height || et.element.offsetHeight\n\t\t\t\t, elW = rect.width || et.element.offsetWidth\n\t\t\t\t, ofsX = winWidth * et.thresholdX\n\t\t\t\t, ofsY = winHeight * et.thresholdY;\n\t\t\t\n\t\t\tvar state = {\n\t\t\t\t\ttopInBounds: (rect.top <= winHeight - ofsY) && (rect.top >= ofsY),\n\t\t\t\t\tbottomInBounds: (rect.bottom >= ofsY) && (rect.bottom <= winHeight - ofsY),\n\t\t\t\t\trightInBounds: (rect.right <= winWidth - ofsX) && (rect.right >= ofsX),\n\t\t\t\t\tleftInBounds: (rect.left >= ofsX) && (rect.left <= winWidth - ofsX),\n\t\t\t\t\txCovered: (rect.left < ofsX) && (rect.right > winWidth - ofsX),\n\t\t\t\t\tyCovered: (rect.top < ofsY) && (rect.bottom > winHeight - ofsY)\n\t\t\t\t};\t\n\t\t\tstate.xVisible = state.xCovered || state.rightInBounds || state.leftInBounds;\n\t\t\tstate.yVisible = state.yCovered || state.topInBounds || state.bottomInBounds;\n\t\t\t\n\t\t\tet.triggerEvents((e && e.scrollEvent)? e.scrollEvent : e, state);\n\t\t\treturn et;\n\t\t};\n\t\t\n\t\tvar unMonitor = scrollMonitor.$on(\"scroll\", et.checkPosition);\n\t\tet.$on(\"$destroyDispatch\", unMonitor);\t\n\t}\n\t\n\tElementTracker.prototype = {\n\t\tthresholdX: 0,\n\t\tthresholdY: 0,\n\t\ttopInView: false,\n\t\tbottomInView: false,\n\t\trightInView: false,\n\t\tleftInView: false,\n\t\txCovered: false,\n\t\tyCovered: false,\n\t\tisInView: false,\n\t\ttriggerEvents: function (originalEvent, newState) {\n\t\t\tvar et = this\n\t\t\t\t, wasVisible = et.isInView\n\t\t\t\t, isVisible = et.isInView = newState.xVisible && newState.yVisible\n\t\t\t\t, createEvent = function (eventType) {\n\t\t\t\t\treturn {type: eventType, scrollEvent: originalEvent, scrollData: et.scrollMonitor}\n\t\t\t\t};\n\t\t\tet.xVisible = newState.xVisible;\n\t\t\tet.yVisible = newState.yVisible;\n\t\t\t\n\t\t\t['top', 'bottom', 'left', 'right'].forEach(function (edge) {\n\t\t\t\tvar inBoundsProp = edge+\"InBounds\"\n\t\t\t\t\t, inViewProp = edge+\"InView\";\n\t\t\t\tif (newState[inBoundsProp] !== et[inViewProp] || isVisible !== wasVisible) {\n\t\t\t\t\tvar edgeIsVisbible = isVisible && newState[inBoundsProp];\t\n\t\t\t\t\tif (edgeIsVisbible !== et[inViewProp]) {\n\t\t\t\t\t\tet[inViewProp] = edgeIsVisbible;\n\t\t\t\t\t\tet.$trigger(createEvent(edgeIsVisbible? (edge+\"EnterView\") : (edge+\"ExitView\")));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif (!wasVisible && isVisible) et.$trigger(createEvent(\"enterView\"));\t\n\t\t\tif (wasVisible && !isVisible) et.$trigger(createEvent(\"exitView\"));\t\t\t\n\t\t\tif (isVisible) et.$trigger(createEvent(\"inView\"));\n\t\t\telse et.$trigger(createEvent(\"outOfView\"));\n\t\t}\n\t};\n\n\t\n\tfunction ScrollMonitor(monitoredElement) {\n\t\tvar m = makeEventDispatch(this)\n\t\t\t, $el = monitoredElement? $(monitoredElement) : $window\n\t\t\t, bindingsMap = [];\n\t\t\n\t\tfunction updateScrollData(e) { \n\t\t\tm.prvPosition = m.position || 0;\n\t\t\tm.position = $el.scrollTop();\n\t\t\tm.scrollDirection = (m.position > m.prvPosition)? \"down\" : \"up\";\n\t\t\tif (m.prvPosition !== m.position) m.$trigger({\n\t\t\t\t\ttype: \"scroll\",\n\t\t\t\t\tscrollEvent: e, \n\t\t\t\t\tscrollData: m\n\t\t\t\t});\n\t\t}\n\t\t\n\t\tm.id = \"scrollMonitor_\"+(++ids);\n\t\tm.element = $el;\n\t\n\t\tm.bind = function (element, thresholdX, thresholdY) {\n\t\t\tvar binding = {\n\t\t\t\telement: element,\n\t\t\t\ttracker: new ElementTracker(m, element, thresholdX, thresholdY)\n\t\t\t};\n\t\t\tbindingsMap.push(binding);\n\t\t\treturn binding.tracker;\n\t\t};\n\t\t\n\t\tm.unbind = function (tracker) {\n\t\t\tbindingsMap.forEach(function (binding, index) {\n\t\t\t\tif (binding.tracker === tracker) {\n\t\t\t\t\tbinding.tracker.$destroyDispatch();\n\t\t\t\t\tbindingsMap.splice(index, 1);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\t\n\t\tm.destroy = function () {\n\t\t\t$el.off(\"scroll.\"+m.id, updateScrollData);\n\t\t\t$window.off(\"resize.\"+m.id, updateScrollData);\n\t\t\tm.$destroyDispatch();\n\t\t\tbindingsMap = null;\n\t\t\tm.bind = function () { throw \"This monitor has been destroyed.\"; };\n\t\t};\n\n\t\t$el.on(\"scroll.\"+m.id, updateScrollData);\n\t\t$window.on(\"resize.\"+m.id, updateScrollData);\n\t\tupdateScrollData({});\n\t}\n\t\n\tScrollMonitor.prototype = {\n\t\tgetOffset: function ($el) { \n\t\t\treturn (($el.css(\"position\")===\"fixed\"? $el.scrollTop() : $el.offset().top)) + $el.height(); \n\t\t},\n\t\tscrollTo: function (element, speed, offset, before, after) {\n\t\t\tvar sp = speed || 400\n\t\t\t\t, _o = (typeof(offset)==\"number\")? offset : 0;\n\t\t\tif (!_o && offset && offset.jquery) _o = this.getOffset(offset);\n\t\t\tif (typeof(element)!==\"number\") element = $(element).offset().top;\n\t\t\tif (before) before();\n\t\t\t$htmlBody.animate( { scrollTop: element - _o }, sp ).promise().done(after);\n\t\t}\n\t};\t\n\t\n\treturn ScrollMonitor;\n})(jQuery || Zepto, require(\"./makeEventDispatch.js\"));\n\nif (typeof module !== 'undefined' && module.exports) module.exports = ScrollMonitor;\nelse if (typeof define == 'function' && define.amd) define(function(){ return ScrollMonitor; });\n","/** @class TransitionMonitor\n * @description dispatches normalised transition/animation start/end end events.\n \t\tProvides utilites for manipulating element and waiting for tranition/animation with promise.\n\t\tIf no event fired or no transition capability present, promise is rejected after maxDuration.\n *\n * @param {Element} DOM element to monitor for animations/transitions\n * @param {Object} options object: {maxDuration: timeToWaitForEvent}\n *\n * @fires transitionMonitor#transitionStart - Event contains: {originalEvent: {Object} original event}\n * @fires transitionMonitor#transitionEnd - Event contains: {originalEvent: {Object} original event}\n * @fires transitionMonitor#animationStart - Event contains: {originalEvent: {Object} original event}\n * @fires transitionMonitor#animationEnd - Event contains: {originalEvent: {Object} original event}\n *\n * @example\n \t\t`var monitor = new TransitionMonitor(<element>, {maxDuration: 400});\n\t\t var animationPromise = monitor.addClass(\"fadeIn\", \"animationEnd\", 300).then(someThing);`\n *\n * @returns a function which tracks and reports on the transitions of element\n *\n * @method breakpointMonitor.manipulate(\n \t\t\tmanipulation<string>, className<string>, type<string>, timeout<number>\n \t\t);`\n *\n * @requires $\n * @requires Promise\n * @requires $browser\n * @requires makeEventDispatch\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nvar TransitionMonitor = (function ($, Promise, $browser, makeEventDispatch, util) {\n\t\n\tvar TRANSITIONEVENT = $browser.transitions, \n\t\tANIMATIONEVENT = $browser.animations;\n\t\n\tfunction TransitionMonitor(element, options) {\n\t\tvar tm = makeEventDispatch(this);\n\t\ttm.element = $(element);\n\t\ttm.options = util.objectAssign({}, TransitionMonitor.prototype.options, options);\n\t\t\n\t\ttm.element.on(TRANSITIONEVENT.start, triggerTS);\n\t\ttm.element.on(TRANSITIONEVENT.end, triggerTE);\n\t\ttm.element.on(ANIMATIONEVENT.start, triggerAS);\n\t\ttm.element.on(ANIMATIONEVENT.end, triggerAE);\n\t\t\n\t\ttm.destroy = function () {\n\t\t\ttm.element.off(TRANSITIONEVENT.start, triggerTS);\n\t\t\ttm.element.off(TRANSITIONEVENT.end, triggerTE);\n\t\t\ttm.element.off(ANIMATIONEVENT.start, triggerAS);\n\t\t\ttm.element.off(ANIMATIONEVENT.end, triggerAE);\n\t\t\ttm.$destroyDispatch();\n\t\t}\n\t\t\n\t\tfunction tmEvnt(t, e) { return {type: t, originalEvent: e} }\n\t\tfunction isElement(e) { return e && (e.target || e.srcElement || e.originalTarget) === tm.element[0] }\n\t\tfunction triggerTS(e) { isElement(e) && tm.$trigger(tmEvnt(\"transitionStart\", e)) }\n\t\tfunction triggerTE(e) { isElement(e) && tm.$trigger(tmEvnt(\"transitionEnd\", e)) }\t\t\n\t\tfunction triggerAS(e) { isElement(e) && tm.$trigger(tmEvnt(\"animationStart\", e)) }\n\t\tfunction triggerAE(e) { isElement(e) && tm.$trigger(tmEvnt(\"animationEnd\", e)) }\n\t}\n\t\n\tTransitionMonitor.prototype = {\n\t\toptions: {\n\t\t\tmaxDuration: 3000\t\t// Set timeout in case of failure\n\t\t},\n\t\taddClass: function (className, type, timeout) {\n\t\t\treturn this.manipulate(\"addClass\", className, type, timeout)\n\t\t},\n\t\tremoveClass: function (className, type, timeout) {\n\t\t\treturn this.manipulate(\"removeClass\", className, type, timeout)\n\t\t},\n\t\ttoggleClass: function (className, type, timeout) {\n\t\t\treturn this.manipulate(\"toggleClass\", className, type, timeout)\n\t\t},\n\t\tmanipulate: function (manipulation, className, type, timeout) {\n\t\t\tvar tm = this;\n\t\t\tif (typeof timeout !== \"number\") timeout = tm.options.maxDuration;\n\t\t\t\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar fail = setTimeout(function () { reject(new Error(\"Transition not detected in time...\")) }, timeout),\n\t\t\t\t\tended = false;\n\t\t\t\tfunction resolvePromise(e) {\n\t\t\t\t\tif (ended) return;\n\t\t\t\t\telse ended = true;\n\t\t\t\t\tclearTimeout(fail);\n\t\t\t\t\tresolve(e);\n\t\t\t\t};\n\t\t\t\ttm.$once(type? type : \"transitionEnd\", resolvePromise);\n\t\t\t\tif (!type) tm.$once(\"animationEnd\", resolvePromise);\n\t\t\t\ttm.element[manipulation](className);\n\t\t\t});\n\t\t}\n\t};\n\t\n\treturn TransitionMonitor;\n\t\n})(jQuery || Zepto, require(\"./pLitr.js\"), require(\"./browsxr.js\"), require(\"./makeEventDispatch.js\"), require(\"../utilities/Util.js\"));\n\nif (typeof module !== 'undefined' && module.exports) module.exports = TransitionMonitor;\nelse if (typeof define == 'function' && define.amd) define(function(){ return TransitionMonitor; });","/** \n * @class util.js\n * @description Collection of useful isht\n *\n * @requires browsxr\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n * @version: 0.1.2\n */\n\nvar utils = (function (browsxr) {\n\tvar util = {requestAnimationFrame: getRaf(), cancelAnimationFrame: getCaf()};\n\t\n\tutil.isUndefined = function(val) {return typeof val === 'undefined'; };\n\tutil.isDefined = function(val) { return !util.isUndefined(val); };\n\tutil.isFunction = function(val) { return typeof val === 'function'; };\n\tutil.isObject = function(val) { return val !== null && typeof val === 'object'; };\n\tutil.isString = function(val) { return typeof val === 'string'; };\n\tutil.isNumber = function(val) { return typeof val === 'number'; };\n\tutil.isArray = Array.isArray;\n\t\n\tutil.arrayDiff = function (A, B) { return A.filter(function (x) { return B.indexOf(x) < 0; }); };\n\t\n\tutil.objectAssign = Object.assign || function (target) {\n\t\tvar output = Object(target);\n\t\tfor (var i = 1, l = arguments.length; i < l; i++) {\n\t\t\tvar source = arguments[i];\n\t\t\tif (source !== undefined && source !== null) {\n\t\t\t\tfor (var k in source) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(source, k))\n\t\t\t\t\t\toutput[k] = source[k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t};\n\tutil.copyObject = function(obj) { return util.objectAssign({}, obj); };\n\tutil.deleteObjProp = function(obj, prop) {\n\t\ttry{ delete obj[prop]; }\n\t\tfinally{ if(obj[prop]) obj[prop]=null; }\n\t\treturn obj;\n\t};\n\tutil.objectToArray = function(obj, arr) {\n\t\tif(obj instanceof Array) return obj;\n\t\tarr = arr || [];\n\t\tfor(var prop in obj) arr.push(obj[prop]);\n\t\treturn arr;\n\t};\n\tutil.objectLength = function (obj) {\n\t\tif(typeof Object.keys == \"function\") return Object.keys(obj).length;\n\t\tvar count = 0;\n\t\tfor(var i in obj)\n\t\t\tif(obj && obj.hasOwnProperty && obj.hasOwnProperty(i)) count++; \n\t\treturn count;\n\t};\n\tutil.objectKeys = function (obj) {\n    var keys = [];\n    for (var key in obj) if (obj.hasOwnProperty(key)) keys.push(key);\n    return keys;\n  };\n\t\n\tutil.toCamelCalse = function(input, delimiters) { \n\t\tvar regX = new RegExp('['+(delimiters? delimiters:'-._') + '](.)', 'g');\n\t\treturn input.toLowerCase().replace(regX, function(match, group1){ return group1.toUpperCase(); });\n\t};\n\tutil.camelCaseTo = function (str, op) {\n\t\treturn str.replace(/([a-z])([A-Z])/g, '$1'+(op||'-')+'$2').toLowerCase();\n\t};\n\t\n\tutil.generateHash = function (length, useNumbers) {\n\t\tvar text = \"\", characters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\n\t\tif(useNumbers) characters += \"0123456789\";\n\t\tfor( var i=0, rl=length||5, l=characters.length; i < rl; i++ )\n\t\t\ttext += characters.charAt(Math.floor(Math.random() * l));\n\t\treturn text;\n\t};\n\t\n\tutil.randomNumber = function (max, min) {\n\t\tif (util.isUndefined(max)) max = 1;\n\t\tif (util.isUndefined(min)) min = 0;\n\t\treturn Math.floor(Math.random() * (max - min + 1)) + min;\n\t};\n\t\n\tutil.preventEvent = function (e, stopImmediate, allowPropagation) { \t// Block event and bubbling\n\t\tif(!e) return false;\n\t\tif(e.preventDefault) e.preventDefault();\n\t\tif(e.stopPropagation && !allowPropagation) e.stopPropagation();\n\t\tif (stopImmediate && e.stopImmediatePropagation) e.stopImmediatePropagation();\n\t\treturn e;\n\t};\n\t\n\tutil.debounce = function (fn, delay, range) {\n\t\tvar timer = null;\n\t\tif(!delay) delay = 10;\n\t\tif(typeof range == \"number\") delay += util.randomNumber(range, Math.random()<0.5);\n\t\treturn function(){\n\t\t\tvar context = this, args = arguments;\n\t\t\tclearTimeout(timer);\n\t\t\ttimer = setTimeout(function(){ fn.apply(context, args); }, delay);\n\t\t};\n\t};\n\t\n\tutil.addCSSRule = function (selector, rules, index, sheet) {\n\t\ttry{\n\t\t\tif(typeof sheet==\"number\") sheet = document.styleSheets[sheet];\n\t\t\telse if(sheet === undefined) sheet = document.styleSheets[document.styleSheets.length - 1];\n\t\t\tif(typeof index!==\"number\") index = sheet.cssRules.length;\n\t\t\tif(\"insertRule\" in sheet) sheet.insertRule(selector + \"{\" + rules + \"}\", index);\n\t\t\telse if(\"addRule\" in sheet) sheet.addRule(selector, rules, index);\n\t\t} catch (e) {}\n\t};\n\t\n\tutil.updatePageTitle = function (title) {\n\t\ttry {\n\t\t\tvar t = title.replace('<','&lt;').replace('>','&gt;').replace(' & ',' &amp; ');\n\t\t\tdocument.getElementsByTagName('title')[0].innerHTML = t;\n\t\t} catch ( Exception ) { }\n\t\tdocument.title = title;\n\t};\n\t\n\t/** addNavigatorDataToHtml\n\t *  @desciption adds window.navigator data to document element as attributes\n\t *  @example: (target chrome13 on windows in css) \n\t *\t\thtml[data-useragent*='Chrome/13.0'][data-platform='Win32'] hits chrome13 on windows\n\t */\n\tutil.addNavigatorDataToHtml = function () {\n\t\tdocument.documentElement.setAttribute('data-useragent', navigator.userAgent);\n\t\tdocument.documentElement.setAttribute('data-platform', navigator.platform);\n\t};\n\n\t/** addJSClass\n\t *  @desciption Adds \"js\" class name to element or document while removing \"no-js\" class\n\t */\n\tutil.addJSClass = function (e) { \n\t\tvar h = e||document.documentElement; \n\t\th.className = ('js '+h.className.replace('no-js','')).trim(); \n\t}\n\n\t/* Damn you mobile browser address bar -__- */\n\tutil.getInnerVH = function () {\t\n\t\treturn Math.min(window.innerHeight, document.documentElement.clientHeight, window.screen?window.screen.height:window.outerHeight);\n\t}\n\tutil.setInnerVHVar = function (vhVarName) {\t\n\t\tdocument.documentElement.style.setProperty(vhVarName||'--vh100', `${util.getInnerVH()}px`);\n\t}\n\t\n\t/** The following depend on jQuery or a compatible replacement availble as `$`\n\t */\n\tutil.toggleOverflow = (function (classn) {\n\t\tfunction tog(el, _hiding){\n\t\t\treturn $(el)[_hiding===undefined? \"toggleClass\" : (_hiding? \"addClass\":\"removeClass\")](classn);\n\t\t}\n\t\ttog.off = function (l) { return tog(l, true) };\n\t\ttog.on = function (l) { return tog(l, false) };\n\t\tutil.addCSSRule(\".\"+classn, \"overflow:hidden !important\");\n\t\tif(browsxr.IOS) util.addCSSRule(\"html.\"+classn+\",body.\"+classn, \"position:relative !important\");\n\t\treturn tog;\n\t})(\"toggleOverflowClass_overflow-on\");\n\n\treturn util;\n})(require(\"./browsxr.js\"));\n\nfunction getRaf() {\n\tvar lastFrameTime = 0;\n\tvar raf = window.requestAnimationFrame\n\t\t|| window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame\n\t\t|| function (callback) {\n\t\t\t\tvar currTime = new Date().getTime();\n\t\t\t\tvar timeToCall = Math.max(0, 16 - (currTime - lastFrameTime));\n\t\t\t\tvar id = window.setTimeout(function() { callback(currTime + timeToCall) }, timeToCall);\n\t\t\t\tlastFrameTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t};\n\treturn function (cb) { return raf.call(window, cb) }\n}\nfunction getCaf() {\n\tvar caf = window.cancelAnimationFrame\n\t\t\t|| window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame\n\t\t\t|| window.webkitCancelRequestAnimationFrame || window.mozCancelRequestAnimationFrame\n\t\t\t|| function (id) { clearTimeout(id); }\n\treturn function (id) { return caf.call(window, id) }\n}\n\nif (typeof module !== 'undefined' && module.exports) module.exports = utils;\nelse if (typeof define == 'function' && define.amd) define(function(){ return utils; });","/** \n * @class viewportMonitor\n * @description Resize events width viewport data in event\n *\n * @fires viewportMonitor#resize - Event contains: viewportDimensions (width, height, prvHWidth, prvHeight (Number)\n *\n * @method viewportDimensionsGet viewport data (width, height, previousWidth, previousHeight)\n \t\t\t`var dimensions = monitor.viewportDimensions()`\n * @method destroy Kill the viewportMonitor (and remove all remaining handlers)\n\t\t\t`monitor.kill()`\n *\n * @example \n \t\t\t`var monitor = new viewportMonitor() \t\t//Create a monitor`\n *\n * @requires jQuery\n * @requires MakeEventDispatch\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nvar ViewportMonitor = (function($, MakeEventDispatch) {\n\tvar $window = $(window)\n\t\t,\tmonitorCount = 0\n\t\t,\tviewportDimensions = {}\n\t\t,\tmonitorDispatch = new MakeEventDispatch()\n\t\t,\tWINDOW_RESIZE_EVENT = \"resize\";\n\t\n\tfunction updateviewportDimensions(e) {\n\t\tvar winWidth = window.innerWidth || window.clientWidth\n\t\t\t,\twinHeight = window.innerHeight ||  window.clientHeight;\n\t\tif (winWidth === viewportDimensions.prvWidth && winHeight === viewportDimensions.prvHeight) \n\t\t\treturn;\n\t\tviewportDimensions.prvWidth = viewportDimensions.width;\n\t\tviewportDimensions.prvHeight = viewportDimensions.height;\n\t\tviewportDimensions.width = winWidth;\n\t\tviewportDimensions.height = winHeight;\n\t\tmonitorDispatch.$trigger({\n\t\t\ttype: WINDOW_RESIZE_EVENT,\n\t\t\tresizeEvent: e, \n\t\t\tviewportDimensions: viewportDimensions\n\t\t});\n\t}\n\t$window.on(\"resize.viewportMonitor\", updateviewportDimensions);\n\tupdateviewportDimensions();\n\t\n\tfunction ViewportMonitor() {\n\t\tvar m = MakeEventDispatch(this);\n\t\tfunction updateListners(e) { \n\t\t\tm.width = e.viewportDimensions.width;\n\t\t\tm.height = e.viewportDimensions.height;\n\t\t\tm.prvHeight = e.viewportDimensions.prvHeight;\n\t\t\tm.prvWidth = e.viewportDimensions.prvWidth;\n\t\t\te.preventDefault && m.$trigger(e); \n\t\t}\n\t\tmonitorDispatch.$on(WINDOW_RESIZE_EVENT, updateListners);\n\t\tupdateListners({viewportDimensions: viewportDimensions});\n\t\t\n\t\tm.destroy = function () {\n\t\t\tm.$destroyDispatch();\n\t\t\tmonitorDispatch.$off(WINDOW_RESIZE_EVENT, updateListners);\n\t\t\tm.bind = function () { throw \"This monitor has been destroyed.\"; };\n\t\t};\n\t}\n\t\t\n\tViewportMonitor.prototype.viewportDimensions = function () { return viewportDimensions; };\n\t\n\treturn ViewportMonitor;\n})(jQuery || Zepto, require(\"./makeEventDispatch.js\"));\n\nif (typeof module !== 'undefined' && module.exports) module.exports = ViewportMonitor;\nelse if (typeof define == 'function' && define.amd) define(function(){ return ViewportMonitor; });\n","/** browsxr.js:  \n * @description object containing some useful info about the browser\n * @example\n\t\t browser.cookiesEnabled @Returns true if cookies are available\n\t\t browser.IE = @Returns a negative value if the browser is not IE or the version number\n\t\t browser.prefix @Returns prefix strings used by the browser\t\t \n\t\t browser.requestAnimationFrame @Returns window.requestAnimationFrame or polyfill\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n * @version: 1.0\n */\n\nvar browsxr = (function (){\n\tvar d = document.documentElement \n\t\t, ua = navigator.userAgent \n\t\t, s = document.body.style\n\t\t, documentComputedStyle = window.getComputedStyle? window.getComputedStyle(d) : [];\n\t\n\tvar b = {\n\t\tlastAnimationFrame: 0\n\t};\n\t\n\tb.cookiesEnabled = navigator.cookieEnabled;\n\tb.IE = (/msie/i.test(ua) && parseFloat)? parseFloat(navigator.appVersion.split(\"MSIE\")[1]) : 0;\n\tb.historyAPI = !!(window.history && history.pushState);\n\tb.Chrome = (!b.IE && /Chrome/i.test(ua));\t\t\t\t\t\t// Not reliable\n\tb.Webkit = (!b.IE && (b.Chrome || /Safari/.test(ua)));\n\tb.Opera = (!b.IE && !b.Webkit && /opera/i.test(ua));\n\tb.IOS = ua.match(/(iPad|iPhone|iPod)/i) || false;\n\tb.Mobile = (Array.prototype.indexOf && (\" \" + d.className + \" \").replace(/[\\n\\t]/g, \" \").indexOf(\"mobile-browser\") > -1);\n\tb.mediaQueries = !window.Modernizr? 0 : (Modernizr.mq('only all'))? 1 : -1;\t// Depends on Modernizr\n\tb.touch = 'ontouchstart' in document.body;\n\tb.backgroundSizing = !!('backgroundSize' in d.style);\n\tb.prefix = (function(){\n\t\tif (documentComputedStyle.length) {\n\t\t\tvar pre = ( \n\t\t\t\t\t\tArray.prototype.slice.call(documentComputedStyle).join('').match(/-(moz|webkit|ms|khtml)-/) \n\t\t\t\t\t\t|| (documentComputedStyle.OLink === '' && ['', 'o']) \n\t\t\t\t\t)[1]\n\t\t\t\t, dom = ('WebKit|Moz|MS|O|Khtml').match(new RegExp('(' + pre + ')', 'i'))[1];\n\t\t\treturn { dom: dom, lowercase: pre, css: '-' + pre + '-', js: pre[0].toUpperCase() + pre.substr(1) };\n\t\t} else {\n\t\t\treturn { dom: 'MS', lowercase: 'ms', css: '-ms-', js: 'Ms' };\n\t\t}\n\t})();\n\tb.placeholders = ('placeholder' in document.createElement('input'));\n\tb.supports = function(prop){\n\t\tif(prop in documentComputedStyle) return prop;\n\t\tprop = prop.replace(/^[a-z]/, function(val){ return val.toUpperCase(); });\n\t\tif(b.prefix.js + prop in s) return b.prefix.lowercase + prop;\n\t\treturn false;\n\t};\n\tb.supportsSvgImg = document.implementation.hasFeature(\"http://www.w3.org/TR/SVG11/feature#Image\", \"1.1\");\n\tb.transitions = b.supports('transition');\n\tif(b.transitions) b.transitions = {\n\t\tstart: (b.transitions==='transition'? 'transitionstart' : b.transitions+'Start'),\n\t\tend: (b.transitions==='transition'? 'transitionend' : b.transitions+'End')\n\t}\n\tb.animations = b.supports('animation');\n\tif(b.animations) b.animations = {\n\t\tstart: (b.animations==='animation'? 'animationstart' : b.animations+'Start'),\n\t\tend: (b.animations==='animation'? 'animationend' : b.animations+'End')\n\t}\n\tb.requestAnimationFrame = window.requestAnimationFrame\n\t\t|| window[b.prefix.lowercase+'RequestAnimationFrame']\n\t\t|| function(callback) {\n\t\t\t\tvar ct = new Date().getTime(), ttc = Math.max(0, 16 - (ct - b.lastAnimationFrame));\n\t\t\t\tb.lastAnimationFrame = ct + ttc;\n\t\t\t\treturn window.setTimeout(function(){ callback(ct + ttc); }, ttc);\n\t\t\t};\n\n\treturn b;\n})();\n\nif (typeof module !== 'undefined' && module.exports) module.exports = browsxr;\nelse if (typeof define == 'function' && define.amd) define(function(){ return browsxr; });","/** \n * @method loadImgSrc\n * @description Load an image, resolving a promise when done.\n *\n * @example \n \t\t`loadImgSrc(\"an/image/url.png\").then(doSomeThing)`\n *\n * @returns Promise\n * @requires Promise\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nvar loadImgSrc = (function(Promise){\n\t\n\treturn function (src) {\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tvar image = new Image();\t\t\n\t\t\timage.onload = resolve;\n\t\t\timage.onerror = reject;\n  \t\timage.src = src;\n\t\t\tif (image.complete && image.naturalWidth) \n\t\t\t\tresolve(); \t\t\t//Hack for browsers that don't trigger load event for cached content\n\t\t});\n\t};\n\t\n})(require(\"./pLitr\"));\n\nif (typeof module !== 'undefined' && module.exports) module.exports = loadImgSrc;\nelse if (typeof define == 'function' && define.amd) define(function(){ return loadImgSrc; });","/** \n * @class viewportMonitor\n * @description Create an event dispatcher, or turn an existing object into one.\n * \n * @example\n \t\t`var dispatch = new MakeEventDispatch();\t\t// Born with event superpowers\n\t\t var mySingleton = new SomeClass();\n\t\t MakeEventDispatch(mySingleton);\t\t\t\t// Enhanced with event superpowers`\n *\n * @method $on Listen for event\n    `var stopFn = dispatch.$on(\"eventName\", function callbackFn(event){ ... })\n     stopFn()\t\t\t\\\\Stop listening for event`\n *\n * @method $once Listen for event and fire callback once. Repeats if callback returns true;\n    `var stopFn = dispatch.$once(\"eventName\", function callbackFn(event){ return $onceAgainBoolean })\n     stopFn()\t\t\t\\\\Stop listening for event`\n * \n * @method $off Alternative way to stop listening\n    `dispatch.$off(\"eventName\", callbackFn)`\n * \n * @method $trigger Trigger an event using event object\n \t\t`var event = {type: \"eventName\", someEventData: \"xxx\"}; \n\t\t dispatch.$trigger(event);`\n * or:\n * @method $trigger Trigger an event using event name\n \t\t`dispatch.$trigger(\"eventName\");`\n * \n * @method $destroyDispatch Remove all listeners and destroy the dispatch capabilities\n \t\t`dispatch.$destroyDispatch();`\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nfunction MakeEventDispatch(owner) {\n\tvar dispatch = owner || {},\n\t\tlisteners = {};\n\n\tdispatch.$on = function (type, callback) {\n\t\tif(!(type in listeners)) listeners[type] = [];\n\t\tlisteners[type].push(callback);\n\t\treturn function() { dispatch.$off(type, callback); };\n\t};\n\n\tdispatch.$once = function (type, callback) {\n\t\tvar removeListener,\n\t\t\tcallbackOnceThen$off = function () {\n\t\t\t\tremoveListener();\n\t\t\t\tcallback.apply(this, arguments);\n\t\t\t};\n\t\tremoveListener = dispatch.$on(type, callbackOnceThen$off);\n\t\treturn removeListener;\n\t};\n\n\tdispatch.$off = function (type, callback) {\n\t\tif(!(type in listeners)) return dispatch; \n\t\tvar stack = listeners[type],\n\t\t\tindex = stack.indexOf(callback);\n\t\tif (index > -1) stack.splice(index, 1);\n\t\treturn dispatch;\n\t};\n\n\tdispatch.$trigger = function (event) {\n\t\tvar _event = (typeof event === \"string\")? {type: event} : event,\n\t\t\t_list;\n\n\t\tif(!(_event.type in listeners)) return dispatch;\n\t\telse _list = listeners[_event.type].slice();\n\n\t\t_event.target = dispatch;\n\t\tif (!_event.preventDefault)\n\t\t\t_event.preventDefault = function () { _event.__eventStopped__ = true; };\n\n\t\tfor(var i = 0, l = _list.length; i < l && _event.__eventStopped__ !== true; i++) {\n\t\t\t_list[i].call(dispatch, _event);\n\t\t}\n\t\treturn dispatch;\n\t};\n\t\n\tdispatch.$destroyDispatch = function () {\n\t\tdispatch.$trigger(\"$destroyDispatch\");\n\t\tfor (var type in listeners) {\n\t\t\tlisteners[type].forEach(function (callback) { dispatch.$off(type, callback); });\n\t\t}\n\t\tdispatch.$on = dispatch.$trigger = function () {};\n\t\tlisteners = null;\n\t};\n\n\treturn dispatch;\n}\n\nif (typeof module !== 'undefined' && module.exports) module.exports = MakeEventDispatch;\nif (typeof define == 'function' && define.amd) define(function(){ return MakeEventDispatch; });","/** \n * @description: Stripped down ES6 compatible promises.\n * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\n * @example: \n\t\t`new Promise(function(resolve, reject){ ... } )\n\t\t\t\t\t.then(function(result){ ... })\n\t\t\t\t\t.catch(function(error){ ... });`\n * @see: Chris Davies https://github.com/chrisdavies/plite\n */\n\nfunction PLitr(resolver) {\n  var promiseChain = function () {},\n      resultGetter;\n\n  function buildChain(onsuccess, onfailure) {\n    var prevChain = promiseChain;\n    promiseChain = function () {\n      prevChain();\n      resultGetter(onsuccess, onfailure);\n    };\n\t}\n\t\n  function processResult(result, callback, reject) {\n    if (result && result.then && result.catch) {\n      result.then(function (data) { processResult(data, callback, reject) })\n\t\t\t\t\t\t.catch(function (err) { processResult(err, reject, reject) });\n    } else {\n      callback(result);\n\t\t}\n\t}\n\t\n  function setResult(callbackRunner) {\n    resultGetter = function (successCallback, failCallback) {\n      try {\n        callbackRunner(successCallback, failCallback);\n      } catch (ex) {\n        failCallback(ex);\n      }\n    };\n    promiseChain();\n    promiseChain = undefined;\n\t}\n\t\n  function setSuccess(data) {\n    setResult(function (success) { success(data) });\n  }\n  function setError(err) {\n    setResult(function (success, fail) { fail(err) });\n  }\n\n\tvar p = {\n\t\tthen: function (callback) {\n\t\t\tvar resolveCallback = resultGetter || buildChain;\n\t\t\treturn PLitr(function (resolve, reject) {\n\t\t\t\tresolveCallback(function (data) { resolve(callback(data)) }, reject);\n\t\t\t});\n\t\t},\n\t\tcatch: function (callback) {\n\t\t\tvar resolveCallback = resultGetter || buildChain;\n\t\t\treturn PLitr(function (resolve, reject) {\n\t\t\t\tresolveCallback(resolve, function (err) { reject(callback(err)) });\n\t\t\t});\n\t\t},\n\t\tresolve: function (result) {\n\t\t\t!resultGetter && processResult(result, setSuccess, setError);\n\t\t},\n\t\treject: function (err) {\n\t\t\t!resultGetter && processResult(err, setError, setError);\n\t\t}\n\t};\n\n  resolver && resolver(p.resolve, p.reject);\n  return p;\n}\n\nPLitr.all = function (promises) {\n\tpromises = promises || [];\n\treturn PLitr(function (resolve, reject) {\n\t\tvar len = promises.length,\n\t\t\t\tcount = len;\n\t\tif(!len) return resolve();\n\n\t\tfunction decrement() { --count <= 0 && resolve(promises); }\n\n\t\tfunction waitFor(p, i) {\n\t\t\tif (p && p.then)\n\t\t\t\tp.then(function (result) {\n\t\t\t\t\tpromises[i] = result;\n\t\t\t\t\tdecrement();\n\t\t\t\t}).catch(reject);\n\t\t\telse\n\t\t\t\tdecrement();\n\t\t}\n\n\t\tfor (var i = 0; i < len; ++i) waitFor(promises[i], i);\n\t});\n};\n\nif (typeof module !== 'undefined' && module.exports) module.exports = window.Promise || PLitr;\nelse if (typeof define == 'function' && define.amd) define(function(){ return window.Promise || PLitr });","/** \n * @function provisionaryPromise:\n * @description Runs a test on a loop \n * \tand resolves a promise when test passes or rejects after time limit exired.\n *\n * @param {String} testName\n * @param {Function} test Test for promise (should return true if test passes)\n * @param {number} timeToWait time to wait before rejecting (default: 5000ms)\n * @param {number} interval frequency at which to repeat (default: 100ms)\n * @returns {Promise} resolved/rejected by success/failure\n * \n * @example\n\t\t`var p = provisionaryPromise(\"loadGoogleFont\", function(){ \n\t\t\t\treturn $(html).hasClass('wf-active') \n\t\t\t}, 5000).then(function domSomething() { ... });`\n\t\t\n * @requires Promise\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nvar provisionaryPromise = (function (Promise) {\n\t\n\treturn function (testName, test, timeToWait, interval) {\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tvar frequency = interval || 100\n\t\t\t\t, timer = timeToWait || 5000\n\t\t\t\t, testRunner\n\t\t\t\t, timeout = setTimeout(function stopTrying() {\n\t\t\t\t\t\tclearInterval(testRunner);\n\t\t\t\t\t\treject(testName+\" timed out in \"+timer+\"ms.\");\n\t\t\t\t\t}, timer);\n\n\t\t\ttestRunner = setInterval(function runTest() {\n\t\t\t\tvar passingResult = test();\n\t\t\t\tif(!passingResult) return;\n\t\t\t\tclearTimeout(timeout);\n\t\t\t\tclearInterval(testRunner);\n\t\t\t\tresolve(passingResult);\n\t\t\t}, frequency);\n\t\t});\n\t}\n})(require(\"./pLitr\"));\n\nif (typeof module !== 'undefined' && module.exports) module.exports = provisionaryPromise;\nelse if (typeof define == 'function' && define.amd) define(function(){ return provisionaryPromise; });\n","/** \n * @method viewUpdater\n * @description Load a view from a remote source and replace a target view with it's content, \n * resolving a promise when done.\n *\n * @example \n\t\t`var updateTarget = viewUpdater($app, $scope, $element, $target);\n\t\t$(window).on('popstate', function(event) {\n\t\t\tupdateTarget({\n\t\t\t\tstate: event.originalEvent.state, \n\t\t\t\ttitle: event.originalEvent.state.title, \n\t\t\t\turl: (window.location.pathname+window.location.search)\n\t\t\t}, {\n\t\t\t\tmainView: $target.selector,\n\t\t\t\tscrollTo: true,\n\t\t\t\tcssTransitions: true,\n\t\t\t\trequestMethod: 'GET',\n\t\t\t\trequestHeaders: undefined,\n\t\t\t\tloadingClass: 'view-loading',\n\t\t\t\ttargetLoadingClass: 'ajax-loading',\n\t\t\t\terrorPage: '/404',\n\t\t\t\tonServerError: function (e, request) { alert('Server Error.') }\n\t\t\t})\n\t\t\t.then(function ($newTargetScope) { ... });\n\t\t})`\n *\n * @returns Promise\n * @requires $scope<Scope>\n * @requires $app<ARENA>\n * @requires $element<HTMLElement>\n * @requires $target<HTMLElement>\n *\n * @author Nathan Johnson <professionalnathan@gmail.com>\n */\n\nfunction viewUpdater ($app, $scope, $element, $target) {\n\treturn function updateTarget(request, data) {\n\t\tvar useCssTransitions = data.cssTransitions && $app.$browser.transitions,\n\t\t\ttransitionInClass = data.targetLoadingClass+'-transition-in',\n\t\t\ttransitionOutClass = data.targetLoadingClass+'-transition-out',\n\t\t\tmonitor;\n\n\t\t$scope.$broadcast({\n\t\t\ttype: '$viewLoading', \n\t\t\trequest: request\n\t\t});\n\t\t\n\t\tif (!useCssTransitions || $target.hasClass(transitionOutClass)) return htmlUpdate();\n\t\t\n\t\t$element.addClass(data.loadingClass);\n\t\tmonitor = new $app.TransitionMonitor($target.removeClass(transitionInClass));\n\t\t\n\t\tfunction httpSuccess(response) {\t\n\t\t\t$scope.$broadcast({\n\t\t\t\ttype: '$viewLoaded',\n\t\t\t\trequest: request,\n\t\t\t\tresponse: response\n\t\t\t});\n\n\t\t\tvar $replacement = $app.$(response.data.targetHtml).addClass(data.targetLoadingClass);\n\t\t\t$scope.$broadcast({\n\t\t\t\ttype: '$viewExit',\n\t\t\t\t$target: $target,\n\t\t\t\t$replacement: $replacement\n\t\t\t});\n\t\t\t$target.triggerHandler('$destroy');\n\n\t\t\tif ($app.isFunction(data.scrollTo)) \n\t\t\t\tdata.scrollTo($target) && $app.$scrollMonitor.scrollTo($target, 0);\n\t\t\telse if (data.scrollTo) \n\t\t\t\twindow.scrollTo($target.offset().top, $target.offset().left);\n\n\t\t\t$replacement.insertBefore($target);\n\t\t\t$target.remove();\n\n\t\t\treturn $app.$compiler\n\t\t\t\t.compile($replacement[0], null, true)\n\t\t\t\t.then(function ($targetScope) {\n\t\t\t\t\t$target = $replacement;\n\t\t\t\t\t$element.removeClass(data.loadingClass);\n\t\t\t\t\t$scope.$broadcast({\n\t\t\t\t\t\ttype: '$viewEnter',\n\t\t\t\t\t\t$target: $replacement\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif (!useCssTransitions) {\n\t\t\t\t\t\t$replacement.removeClass(data.targetLoadingClass);\n\t\t\t\t\t\treturn $targetScope;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn new $app.Promise(function (resolve) {\n\t\t\t\t\t\t\tmonitor = new $app.TransitionMonitor($replacement);\n\t\t\t\t\t\t\t$app.requestAnimationFrame(function () {\n\t\t\t\t\t\t\t\tvar endUpdate = function () {\n\t\t\t\t\t\t\t\t\tmonitor.destroy();\n\t\t\t\t\t\t\t\t\t$replacement.removeClass(data.targetLoadingClass);\n\t\t\t\t\t\t\t\t\tresolve($targetScope);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tmonitor.addClass(transitionInClass).then(endUpdate).catch(endUpdate);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\n\t\tfunction httpError(e) { \n\t\t\tif (404===e.status) {\n\t\t\t\tif (request.url.indexOf(data.errorPage) < 0) {\n\t\t\t\t\treturn updateTarget({\n\t\t\t\t\t\tstate: {targetElement: data.mainView}, \n\t\t\t\t\t\ttitle: request.state.title, \n\t\t\t\t\t\turl: data.errorPage,\n\t\t\t\t\t\tredirectedUrl: request.url\n\t\t\t\t\t}, data);\n\t\t\t\t} else {\n\t\t\t\t\talert('The path '+ (request.redirectedUrl || request.url) +' could not be found...');\n\t\t\t\t}\n\t\t\t} else if(500===e.status && data.onServerError) {\n\t\t\t\tdata.onServerError(e, request);\n\t\t\t}\n\t\t\tconsole.error(\"Http error: \", e);\n\t\t\t$scope.$broadcast({\n\t\t\t\ttype: '$viewEnter',\n\t\t\t\terror: e\n\t\t\t});\n\t\t\t$target.removeClass(transitionOutClass).addClass(transitionInClass);\n\t\t\t$element.removeClass(data.loadingClass);\n\t\t}\n\n\t\tfunction htmlUpdate() {\n\t\t\tmonitor && monitor.destroy();\n\t\t\treturn $app.$provider.service(\"$router\").http(request).then(httpSuccess).catch(httpError);\n\t\t}\n\n\t\treturn monitor.addClass(transitionOutClass).then(htmlUpdate).catch(htmlUpdate);\n\t}\n}\n\nif (typeof module !== 'undefined' && module.exports) module.exports = viewUpdater;\nelse if (typeof define == 'function' && define.amd) define(function(){ return viewUpdater });"],"sourceRoot":""}